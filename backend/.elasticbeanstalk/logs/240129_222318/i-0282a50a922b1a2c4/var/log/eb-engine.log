2024/01/29 18:17:34.123617 [INFO] Starting...
2024/01/29 18:17:34.123672 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 18:17:34.123752 [INFO] reading event message file
2024/01/29 18:17:34.131892 [INFO] Engine received EB command userdata-exec

2024/01/29 18:17:34.203370 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:17:35.071102 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:17:36.071441 [INFO] Unable to ping launch url, this is a scale-up instance.
2024/01/29 18:17:36.071531 [INFO] Engine command: (self-startup)

2024/01/29 18:17:36.071539 [INFO] Downloading EB Application...
2024/01/29 18:17:36.071543 [INFO] Region: eu-west-1
2024/01/29 18:17:36.071547 [INFO] envID: e-8gmkc7rmw6
2024/01/29 18:17:36.071550 [INFO] envBucket: elasticbeanstalk-eu-west-1-471947097906
2024/01/29 18:17:36.071554 [INFO] Using manifest file name from command request
2024/01/29 18:17:36.071571 [INFO] Unable to get version manifest file.
2024/01/29 18:17:36.071575 [INFO] Downloading latest manifest available.
2024/01/29 18:17:36.071578 [INFO] Download latest app version manifest
2024/01/29 18:17:36.071736 [INFO] resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest
2024/01/29 18:17:36.116475 [INFO] latestManifest key *: resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706550848895

2024/01/29 18:17:36.116738 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706550848895
2024/01/29 18:17:36.131165 [INFO] Download successful50bytes downloaded
2024/01/29 18:17:36.131292 [INFO] Trying to read and parse version manifest...
2024/01/29 18:17:36.131322 [INFO] Downloading file with path: /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 18:17:36.131409 [INFO] URL: https://elasticbeanstalk-platform-assets-eu-west-1.s3.eu-west-1.amazonaws.com/stalks/eb_docker_amazon_linux_2023_1.0.420.0_20240123011222/sampleapp/EBSampleApp-Docker.zip
2024/01/29 18:17:36.188723 [INFO] Finished download file from https://elasticbeanstalk-platform-assets-eu-west-1.s3.eu-west-1.amazonaws.com/stalks/eb_docker_amazon_linux_2023_1.0.420.0_20240123011222/sampleapp/EBSampleApp-Docker.zip
2024/01/29 18:17:36.189282 [INFO] Executing instruction: SyncClock
2024/01/29 18:17:36.189292 [INFO] Starting SyncClock
2024/01/29 18:17:36.189306 [INFO] Running command /bin/sh -c /usr/bin/chronyc tracking
2024/01/29 18:17:36.198700 [INFO] Reference ID    : A9FEA97B (169.254.169.123)
Stratum         : 4
Ref time (UTC)  : Mon Jan 29 18:17:35 2024
System time     : 0.151309907 seconds slow of NTP time
Last offset     : +0.000012645 seconds
RMS offset      : 0.000012645 seconds
Frequency       : 0.295 ppm fast
Residual freq   : +2.476 ppm
Skew            : 0.066 ppm
Root delay      : 0.000376143 seconds
Root dispersion : 0.000390292 seconds
Update interval : 1.8 seconds
Leap status     : Normal

2024/01/29 18:17:36.198722 [INFO] Running command /bin/sh -c /usr/bin/chronyc -a makestep
2024/01/29 18:17:36.354490 [INFO] 200 OK

2024/01/29 18:17:36.354627 [INFO] Skipping Configure OS
2024/01/29 18:17:36.354634 [INFO] Skipping LockRepo
2024/01/29 18:17:36.354639 [INFO] Skipping GenerateEBBanner
2024/01/29 18:17:36.354645 [INFO] Skipping Install Process Manager
2024/01/29 18:17:36.354650 [INFO] Skipping install syslog
2024/01/29 18:17:36.354656 [INFO] Skipping install cron
2024/01/29 18:17:36.354661 [INFO] Skipping install proxy
2024/01/29 18:17:36.354666 [INFO] Skipping installhealthd
2024/01/29 18:17:36.354672 [INFO] Skipping Install Log Streaming Manager
2024/01/29 18:17:36.354677 [INFO] Skipping install X-Ray
2024/01/29 18:17:36.354683 [INFO] Skipping install Third Party License
2024/01/29 18:17:36.354689 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:36.354700 [INFO] Executing instruction: installSqsd
2024/01/29 18:17:36.354704 [INFO] This is a web server environment instance, skip install sqsd daemon ...
2024/01/29 18:17:36.354710 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:36.354713 [INFO] Executing instruction: bootstraphealthd
2024/01/29 18:17:36.354716 [INFO] this is an enhanced health env ...
2024/01/29 18:17:36.354728 [INFO] bootstrap healthd....
2024/01/29 18:17:36.354741 [INFO] Running command /bin/sh -c /usr/bin/id -u healthd || /usr/sbin/useradd --user-group healthd -s /sbin/nologin --create-home
2024/01/29 18:17:36.960557 [INFO] /usr/bin/id: ‘healthd’: no such user

2024/01/29 18:17:36.965817 [INFO] none proxy, skip creating proxy dir for healthd
2024/01/29 18:17:36.965837 [INFO] bootstrap healthd....
2024/01/29 18:17:36.965853 [INFO] Running command /bin/sh -c /usr/bin/id -u healthd || /usr/sbin/useradd --user-group healthd -s /sbin/nologin --create-home
2024/01/29 18:17:36.970046 [INFO] 1001

2024/01/29 18:17:36.972756 [INFO] configure bundle log for healthd...
2024/01/29 18:17:36.972962 [INFO] Skipping Install yum packages
2024/01/29 18:17:36.972969 [INFO] Skipping install docker-compose
2024/01/29 18:17:36.972975 [INFO] Skipping Configure Docker Daemon
2024/01/29 18:17:36.972981 [INFO] Skipping MarkBaked
2024/01/29 18:17:36.972988 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:36.972991 [INFO] Executing instruction: TuneSystemSettings
2024/01/29 18:17:36.972994 [INFO] Starting TuneSystemSettings
2024/01/29 18:17:36.972999 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:36.974243 [INFO] Executing instruction: GetSetupLogRotate
2024/01/29 18:17:36.974247 [INFO] Initialize LogRotate files and directories
2024/01/29 18:17:36.987361 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:36.987372 [INFO] Executing instruction: BootstrapCFNHup
2024/01/29 18:17:36.987375 [INFO] Bootstrap cfn-hup
2024/01/29 18:17:36.988704 [INFO] Copying file /opt/elasticbeanstalk/config/private/aws-eb-command-handler.conf to /etc/cfn/hooks.d/aws-eb-command-handler.conf
2024/01/29 18:17:36.989566 [INFO] Executing instruction: StartCFNHup
2024/01/29 18:17:36.989574 [INFO] Start cfn-hup
2024/01/29 18:17:36.989592 [INFO] Running command /bin/sh -c systemctl show -p PartOf cfn-hup.service
2024/01/29 18:17:37.018744 [INFO] cfn-hup is not registered with EB yet, registering it now
2024/01/29 18:17:37.018783 [INFO] Running command /bin/sh -c systemctl show -p PartOf cfn-hup.service
2024/01/29 18:17:37.039371 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:17:37.643578 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:17:37.655984 [INFO] Running command /bin/sh -c systemctl is-enabled aws-eb.target
2024/01/29 18:17:37.671208 [INFO] Running command /bin/sh -c systemctl enable aws-eb.target
2024/01/29 18:17:38.268791 [INFO] Running command /bin/sh -c systemctl start aws-eb.target
2024/01/29 18:17:38.288375 [INFO] Running command /bin/sh -c systemctl enable cfn-hup.service
2024/01/29 18:17:38.792841 [INFO] Synchronizing state of cfn-hup.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable cfn-hup
Created symlink /etc/systemd/system/multi-user.target.wants/cfn-hup.service → /etc/systemd/system/cfn-hup.service.

2024/01/29 18:17:38.792876 [INFO] Running command /bin/sh -c systemctl is-active cfn-hup.service
2024/01/29 18:17:38.810656 [INFO] cfn-hup process is not running, starting it now
2024/01/29 18:17:38.810684 [INFO] Running command /bin/sh -c systemctl show -p PartOf cfn-hup.service
2024/01/29 18:17:38.835097 [INFO] Running command /bin/sh -c systemctl is-active cfn-hup.service
2024/01/29 18:17:38.853867 [INFO] Running command /bin/sh -c systemctl start cfn-hup.service
2024/01/29 18:17:38.962407 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:38.962424 [INFO] Executing instruction: SetupPublishLogCronjob
2024/01/29 18:17:38.962428 [INFO] Setup publish logs cron job...
2024/01/29 18:17:38.962439 [INFO] Copying file /opt/elasticbeanstalk/config/private/logtasks/cron/publishlogs to /etc/cron.d/publishlogs
2024/01/29 18:17:38.963994 [INFO] Executing instruction: Start Docker
2024/01/29 18:17:38.964002 [INFO] Starting Docker...
2024/01/29 18:17:38.964066 [INFO] Copying file /opt/elasticbeanstalk/config/private/docker-log.conf to /etc/systemd/system/docker.service.d/docker-log.conf
2024/01/29 18:17:38.965023 [INFO] Copying file /opt/elasticbeanstalk/config/private/docker-rsyslog.conf to /etc/rsyslog.d/docker-log.conf
2024/01/29 18:17:38.965951 [INFO] Running command /bin/sh -c systemctl restart rsyslog.service
2024/01/29 18:17:39.289062 [INFO] Running command /bin/sh -c systemctl show -p PartOf docker.service
2024/01/29 18:17:39.322200 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:17:39.827385 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:17:39.843920 [INFO] Running command /bin/sh -c systemctl show -p PartOf docker.service
2024/01/29 18:17:39.862374 [INFO] Running command /bin/sh -c systemctl is-active docker.service
2024/01/29 18:17:39.880536 [INFO] Running command /bin/sh -c systemctl start docker.service
2024/01/29 18:17:42.210175 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:42.210197 [INFO] Executing instruction: Setup Docker Options
2024/01/29 18:17:42.210200 [INFO] Setting up configurations for docker platform
2024/01/29 18:17:42.219605 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-events.service
2024/01/29 18:17:42.258902 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:17:42.839483 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:17:42.863692 [INFO] Running command /bin/sh -c systemctl enable eb-docker-events.service
2024/01/29 18:17:43.428490 [INFO] Created symlink /etc/systemd/system/docker.service.wants/eb-docker-events.service → /etc/systemd/system/eb-docker-events.service.

2024/01/29 18:17:43.428528 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-events.service
2024/01/29 18:17:43.444503 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-events.service
2024/01/29 18:17:43.463047 [INFO] Running command /bin/sh -c systemctl start eb-docker-events.service
2024/01/29 18:17:43.593228 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:43.593247 [INFO] Executing instruction: MarkBootstrapped
2024/01/29 18:17:43.593250 [INFO] Starting MarkBootstrapped
2024/01/29 18:17:43.593256 [INFO] Instance has NOT been bootstrapped
2024/01/29 18:17:43.593651 [INFO] Marked instance as Bootstrapped
2024/01/29 18:17:43.593659 [INFO] Executing instruction: Save CFN Stack Info
2024/01/29 18:17:43.593720 [INFO] Starting SwitchCFNStack
2024/01/29 18:17:43.593725 [INFO] Executing instruction: stopSqsd
2024/01/29 18:17:43.593729 [INFO] This is a web server environment instance, skip stop sqsd daemon ...
2024/01/29 18:17:43.593732 [INFO] Executing instruction: PreBuildEbExtension
2024/01/29 18:17:43.593736 [INFO] Starting executing the config set Infra-EmbeddedPreBuild.
2024/01/29 18:17:43.593756 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPreBuild
2024/01/29 18:17:44.449989 [INFO] Finished executing the config set Infra-EmbeddedPreBuild.

2024/01/29 18:17:44.450020 [INFO] Executing instruction: StagedockerApplication
2024/01/29 18:17:44.450033 [INFO] Running command /bin/sh -c docker ps -a -q -f status=running
2024/01/29 18:17:44.511176 [INFO] Pruning containers ...
2024/01/29 18:17:44.511208 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:17:44.581382 [INFO] CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

2024/01/29 18:17:44.581416 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 18:17:44.650286 [INFO] Total reclaimed space: 0B

2024/01/29 18:17:44.650314 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:17:44.712472 [INFO] CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

2024/01/29 18:17:44.712705 [INFO] Running command /bin/sh -c /bin/file -m /opt/elasticbeanstalk/config/private/beanstalk-magic -b --mime-type /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 18:17:44.719016 [INFO] application/zip

2024/01/29 18:17:44.719030 [INFO] app source bundle is zip file ...
2024/01/29 18:17:44.719035 [INFO] extracting /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/
2024/01/29 18:17:44.719056 [INFO] Running command /bin/sh -c /usr/bin/unzip -q -o /opt/elasticbeanstalk/deployment/app_source_bundle -d /var/app/staging/
2024/01/29 18:17:44.723461 [INFO] finished extracting /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/ successfully
2024/01/29 18:17:44.723478 [INFO] Executing instruction: RunAppDeployPreBuildHooks
2024/01/29 18:17:44.723553 [INFO] Executing platform hooks in .platform/hooks/prebuild/
2024/01/29 18:17:44.723569 [INFO] The dir .platform/hooks/prebuild/ does not exist
2024/01/29 18:17:44.723573 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/prebuild
2024/01/29 18:17:44.723578 [INFO] Executing instruction: Generate environment file
2024/01/29 18:17:44.723622 [INFO] Executing instruction: Docker Specific Build Application
2024/01/29 18:17:44.723627 [INFO] start build docker app
2024/01/29 18:17:44.723819 [INFO] fetching image names from Dockerfile /var/app/staging/Dockerfile
2024/01/29 18:17:44.723871 [INFO] found images [public.ecr.aws/docker/library/python:3.8] in Dockerfile /var/app/staging/Dockerfile
2024/01/29 18:17:44.723877 [INFO] pull docker image if update is not false in Dockerrun.aws.json
2024/01/29 18:17:44.723880 [INFO] start to build docker image
2024/01/29 18:17:44.723901 [INFO] Running command /bin/sh -c docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/29 18:18:14.648865 [INFO] #0 building with "default" instance using docker driver

#1 [internal] load .dockerignore
#1 transferring context: 2B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 267B done
#2 DONE 0.0s

#3 [internal] load metadata for public.ecr.aws/docker/library/python:3.8
#3 DONE 1.4s

#4 [internal] load build context
#4 transferring context: 5.30kB done
#4 DONE 0.0s

#5 [1/2] FROM public.ecr.aws/docker/library/python:3.8@sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794
#5 resolve public.ecr.aws/docker/library/python:3.8@sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794 0.0s done
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 0B / 49.56MB 0.1s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 0B / 24.05MB 0.1s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 0B / 64.14MB 0.1s
#5 sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794 1.86kB / 1.86kB done
#5 sha256:8a90415600108404fbe6f011c525e78dc2709d54c973738b1b960f69f361aef4 7.38kB / 7.38kB done
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 6.29MB / 24.05MB 0.2s
#5 sha256:fb36df8267c3a647ab9a1af81d1696d3274c0c41c804af0d110b80b79fe4c270 2.01kB / 2.01kB done
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 6.29MB / 49.56MB 0.3s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 12.58MB / 24.05MB 0.3s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 12.58MB / 49.56MB 0.4s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 20.97MB / 24.05MB 0.4s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 20.97MB / 49.56MB 0.6s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 24.05MB / 24.05MB 0.6s done
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 6.80MB / 64.14MB 0.6s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 0B / 211.10MB 0.6s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 30.41MB / 49.56MB 0.8s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 15.73MB / 64.14MB 0.8s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 36.70MB / 49.56MB 0.9s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 19.92MB / 64.14MB 0.9s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 23.27MB / 64.14MB 1.0s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 47.19MB / 49.56MB 1.2s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 33.10MB / 64.14MB 1.2s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 16.78MB / 211.10MB 1.2s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 37.69MB / 64.14MB 1.3s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 49.56MB / 49.56MB 1.4s done
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 46.14MB / 64.14MB 1.5s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 0B / 6.39MB 1.5s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 28.31MB / 211.10MB 1.6s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 1.05MB / 6.39MB 1.6s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 53.48MB / 64.14MB 1.8s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 5.24MB / 6.39MB 1.8s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 6.39MB / 6.39MB 1.9s
#5 extracting sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 59.77MB / 64.14MB 2.0s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 39.85MB / 211.10MB 2.0s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 6.39MB / 6.39MB 1.9s done
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 0B / 17.28MB 2.0s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 64.14MB / 64.14MB 2.2s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 4.19MB / 17.28MB 2.2s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 64.14MB / 64.14MB 2.2s done
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 51.38MB / 211.10MB 2.3s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 9.44MB / 17.28MB 2.3s
#5 sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092 0B / 246B 2.3s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 15.73MB / 17.28MB 2.5s
#5 sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092 246B / 246B 2.4s done
#5 sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 0B / 2.85MB 2.5s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 66.06MB / 211.10MB 2.7s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 17.28MB / 17.28MB 2.6s done
#5 sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 2.85MB / 2.85MB 2.7s done
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 79.69MB / 211.10MB 3.0s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 91.23MB / 211.10MB 3.2s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 111.15MB / 211.10MB 3.6s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 130.02MB / 211.10MB 4.0s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 142.61MB / 211.10MB 4.3s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 154.14MB / 211.10MB 4.5s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 170.92MB / 211.10MB 4.8s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 185.60MB / 211.10MB 5.1s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 205.52MB / 211.10MB 5.6s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 211.10MB / 211.10MB 5.8s done
#5 extracting sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 5.1s
#5 extracting sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 7.4s done
#5 extracting sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c
#5 extracting sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 1.2s done
#5 extracting sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980
#5 extracting sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 4.3s done
#5 extracting sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2
#5 extracting sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 5.1s
#5 extracting sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 10.0s done
#5 extracting sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a
#5 extracting sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 0.4s done
#5 extracting sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72
#5 extracting sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 0.8s done
#5 extracting sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092 done
#5 extracting sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e
#5 extracting sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 0.3s done
#5 DONE 27.3s

#6 [2/2] ADD application.py /tmp/application.py
#6 DONE 0.1s

#7 exporting to image
#7 exporting layers 0.0s done
#7 writing image sha256:ca5fa1deae93591be22dafa0525dc72c8a62a15dfd86bbcc40bc9bfde967b94d done
#7 naming to docker.io/aws_beanstalk/staging-app done
#7 DONE 0.0s

2024/01/29 18:18:14.650212 [INFO] successfully execute command: docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/29 18:18:14.650223 [INFO] successfully build docker image
2024/01/29 18:18:14.650225 [INFO] save staging docker image id
2024/01/29 18:18:14.651962 [INFO] Running command /bin/sh -c docker images aws_beanstalk/staging-app -q
2024/01/29 18:18:14.739878 [INFO] ca5fa1deae93

2024/01/29 18:18:14.740044 [INFO] Executing instruction: configure X-Ray
2024/01/29 18:18:14.740050 [INFO] X-Ray is not enabled.
2024/01/29 18:18:14.740053 [INFO] Executing instruction: configure proxy Nginx
2024/01/29 18:18:14.749956 [INFO] Executing instruction: configure healthd specific proxy conf
2024/01/29 18:18:14.752395 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:18:14.797809 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:18:15.087988 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:18:15.098921 [INFO] Running command /bin/sh -c systemctl is-enabled aws-eb.target
2024/01/29 18:18:15.108449 [INFO] Running command /bin/sh -c systemctl enable aws-eb.target
2024/01/29 18:18:15.382877 [INFO] Running command /bin/sh -c systemctl start aws-eb.target
2024/01/29 18:18:15.394214 [INFO] Running command /bin/sh -c systemctl enable healthd.service
2024/01/29 18:18:15.668692 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/healthd.service → /etc/systemd/system/healthd.service.

2024/01/29 18:18:15.668731 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:18:15.680781 [INFO] Running command /bin/sh -c systemctl is-active healthd.service
2024/01/29 18:18:15.690168 [INFO] Running command /bin/sh -c systemctl start healthd.service
2024/01/29 18:18:15.766738 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_logformat.conf to /var/proxy/staging/nginx/conf.d/healthd_logformat.conf
2024/01/29 18:18:15.768267 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_nginx.conf to /var/proxy/staging/nginx/conf.d/elasticbeanstalk/healthd.conf
2024/01/29 18:18:15.768966 [INFO] Executing instruction: configure log streaming
2024/01/29 18:18:15.768975 [INFO] log streaming is not enabled
2024/01/29 18:18:15.768977 [INFO] disable log stream
2024/01/29 18:18:15.768989 [INFO] Running command /bin/sh -c systemctl show -p PartOf amazon-cloudwatch-agent.service
2024/01/29 18:18:15.787374 [INFO] Running command /bin/sh -c systemctl stop amazon-cloudwatch-agent.service
2024/01/29 18:18:15.802767 [INFO] Executing instruction: GetToggleForceRotate
2024/01/29 18:18:15.802788 [INFO] Checking if logs need forced rotation
2024/01/29 18:18:15.802813 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:18:16.434417 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:18:16.950224 [INFO] Procfile not found. Generating default rsyslog config
2024/01/29 18:18:16.952478 [INFO] Running command /bin/sh -c systemctl restart rsyslog.service
2024/01/29 18:18:17.331670 [INFO] Executing instruction: Configure Docker Logging
2024/01/29 18:18:17.348512 [INFO] Executing instruction: PostBuildEbExtension
2024/01/29 18:18:17.348527 [INFO] Starting executing the config set Infra-EmbeddedPostBuild.
2024/01/29 18:18:17.348539 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPostBuild
2024/01/29 18:18:17.835116 [INFO] Finished executing the config set Infra-EmbeddedPostBuild.

2024/01/29 18:18:17.835167 [INFO] Executing instruction: CleanEbExtensions
2024/01/29 18:18:17.835191 [INFO] Cleaned ebextensions subdirectories from app staging directory.
2024/01/29 18:18:17.835195 [INFO] Executing instruction: RunAppDeployPreDeployHooks
2024/01/29 18:18:17.835219 [INFO] Executing platform hooks in .platform/hooks/predeploy/
2024/01/29 18:18:17.835231 [INFO] The dir .platform/hooks/predeploy/ does not exist
2024/01/29 18:18:17.835233 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/predeploy
2024/01/29 18:18:17.835239 [INFO] Executing instruction: stop X-Ray
2024/01/29 18:18:17.835241 [INFO] stop X-Ray ...
2024/01/29 18:18:17.835251 [INFO] Running command /bin/sh -c systemctl show -p PartOf xray.service
2024/01/29 18:18:17.852177 [WARN] stopProcess Warning: process xray is not registered 
2024/01/29 18:18:17.852203 [INFO] Running command /bin/sh -c systemctl stop xray.service
2024/01/29 18:18:17.866903 [INFO] Executing instruction: Run Docker Container
2024/01/29 18:18:17.866934 [INFO] this is the first time deploying app...
2024/01/29 18:18:17.866938 [INFO] Removing /var/app/current/ if it exists
2024/01/29 18:18:17.866945 [INFO] Renaming /var/app/staging/ to /var/app/current/
2024/01/29 18:18:17.866965 [INFO] detected new app is not docker compose app
2024/01/29 18:18:17.867077 [INFO] Running command /bin/sh -c docker run -d --env-file /opt/elasticbeanstalk/deployment/env.list -v /var/log/eb-docker/containers/eb-current-app:/tmp/sample-app  ca5fa1deae93 
2024/01/29 18:18:18.762279 [INFO] eb858debfb6ad7fbba431ca7ad177a67c09ba67f597c5b07fa57d0bdc9de0e8e

2024/01/29 18:18:23.766720 [INFO] Running command /bin/sh -c docker ps | grep -q eb858debfb6a
2024/01/29 18:18:23.815506 [INFO] Clear existing beanstalk iptables rules...
2024/01/29 18:18:23.815536 [INFO] Running command /bin/sh -c iptables-save | grep -v added_by_elasticbeanstalk | iptables-restore
2024/01/29 18:18:23.890626 [INFO] Getting container info...
2024/01/29 18:18:23.890655 [INFO] Running command /bin/sh -c docker inspect eb858debfb6ad7fbba431ca7ad177a67c09ba67f597c5b07fa57d0bdc9de0e8e

2024/01/29 18:18:23.921754 [INFO] Running command /bin/sh -c ip route show default | awk '{print $5}'
2024/01/29 18:18:23.944402 [INFO] ens5

2024/01/29 18:18:23.944444 [INFO] Writing nginx upstream config...
2024/01/29 18:18:23.947682 [INFO] Running command /bin/sh -c /usr/sbin/nginx -t -c /var/proxy/staging/nginx/nginx.conf
2024/01/29 18:18:23.988131 [INFO] nginx: [warn] could not build optimal types_hash, you should increase either types_hash_max_size: 1024 or types_hash_bucket_size: 64; ignoring types_hash_bucket_size
nginx: the configuration file /var/proxy/staging/nginx/nginx.conf syntax is ok
nginx: configuration file /var/proxy/staging/nginx/nginx.conf test is successful

2024/01/29 18:18:23.988205 [INFO] Running command /bin/sh -c cp -rp /var/proxy/staging/nginx/* /etc/nginx
2024/01/29 18:18:23.994130 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:18:24.018233 [INFO] register process nginx
2024/01/29 18:18:24.018280 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:18:24.038794 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:18:24.312261 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:18:24.321848 [INFO] Running command /bin/sh -c systemctl enable nginx.service
2024/01/29 18:18:24.590285 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service → /usr/lib/systemd/system/nginx.service.

2024/01/29 18:18:24.590323 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:18:24.610580 [INFO] Running command /bin/sh -c systemctl restart nginx.service
2024/01/29 18:18:24.796327 [INFO] Running command /bin/sh -c service iptables save
2024/01/29 18:18:24.883102 [INFO] iptables: Saving firewall rules to /etc/sysconfig/iptables: [  OK  ]

2024/01/29 18:18:24.883118 [INFO] Traffic forward set-up completed.
2024/01/29 18:18:24.883121 [INFO] making STAGING app container current...
2024/01/29 18:18:24.883142 [INFO] Running command /bin/sh -c docker tag ca5fa1deae93 aws_beanstalk/current-app
2024/01/29 18:18:24.928936 [INFO] Running command /bin/sh -c docker rmi aws_beanstalk/staging-app
2024/01/29 18:18:24.951467 [INFO] Untagged: aws_beanstalk/staging-app:latest

2024/01/29 18:18:24.951594 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:18:24.970581 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:18:25.299787 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:18:25.309459 [INFO] Running command /bin/sh -c systemctl enable eb-docker.service
2024/01/29 18:18:25.590988 [INFO] The unit files have no installation config (WantedBy=, RequiredBy=, Also=,
Alias= settings in the [Install] section, and DefaultInstance= for template
units). This means they are not meant to be enabled using systemctl.
 
Possible reasons for having this kind of units are:
• A unit may be statically enabled by being symlinked from another unit's
  .wants/ or .requires/ directory.
• A unit's purpose may be to act as a helper for some other unit which has
  a requirement dependency on it.
• A unit may be started when needed via activation (socket, path, timer,
  D-Bus, udev, scripted systemctl call, ...).
• In case of template units, the unit is meant to be enabled with some
  instance name specified.

2024/01/29 18:18:25.591020 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:18:25.604833 [INFO] Running command /bin/sh -c systemctl is-active eb-docker.service
2024/01/29 18:18:25.614832 [INFO] Running command /bin/sh -c systemctl start eb-docker.service
2024/01/29 18:18:25.672545 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/29 18:18:25.690781 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:18:26.167356 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:18:26.198557 [INFO] Running command /bin/sh -c systemctl enable eb-docker-log.service
2024/01/29 18:18:26.647991 [INFO] Created symlink /etc/systemd/system/eb-docker.service.wants/eb-docker-log.service → /etc/systemd/system/eb-docker-log.service.

2024/01/29 18:18:26.648048 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/29 18:18:26.666257 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-log.service
2024/01/29 18:18:26.677195 [INFO] Running command /bin/sh -c systemctl start eb-docker-log.service
2024/01/29 18:18:26.789240 [INFO] docker container eb858debfb6a is running aws_beanstalk/current-app
2024/01/29 18:18:26.789258 [INFO] Cleanup images ...
2024/01/29 18:18:26.789271 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:18:26.821556 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED          SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   12 seconds ago   998MB

2024/01/29 18:18:26.821587 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/29 18:18:26.895979 [INFO] Error response from daemon: conflict: unable to delete ca5fa1deae93 (cannot be forced) - image is being used by running container eb858debfb6a

2024/01/29 18:18:26.896011 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:18:26.936258 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED          SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   12 seconds ago   998MB

2024/01/29 18:18:26.936283 [INFO] Executing instruction: start X-Ray
2024/01/29 18:18:26.936289 [INFO] X-Ray is not enabled.
2024/01/29 18:18:26.936293 [INFO] Executing instruction: configureSqsd
2024/01/29 18:18:26.936298 [INFO] This is a web server environment instance, skip configure sqsd daemon ...
2024/01/29 18:18:26.936302 [INFO] Executing instruction: startSqsd
2024/01/29 18:18:26.936305 [INFO] This is a web server environment instance, skip start sqsd daemon ...
2024/01/29 18:18:26.936311 [INFO] Executing instruction: Track pids in healthd
2024/01/29 18:18:26.936315 [INFO] This is an enhanced health env...
2024/01/29 18:18:26.936329 [INFO] Running command /bin/sh -c systemctl show -p ConsistsOf aws-eb.target | cut -d= -f2
2024/01/29 18:18:26.952745 [INFO] healthd.service eb-docker-events.service eb-docker-log.service docker.service cfn-hup.service eb-docker.service nginx.service

2024/01/29 18:18:26.952782 [INFO] Running command /bin/sh -c systemctl show -p ConsistsOf eb-app.target | cut -d= -f2
2024/01/29 18:18:26.970120 [INFO] 

2024/01/29 18:18:26.973956 [INFO] Executing instruction: RunAppDeployPostDeployHooks
2024/01/29 18:18:26.975019 [INFO] Executing platform hooks in .platform/hooks/postdeploy/
2024/01/29 18:18:26.975056 [INFO] The dir .platform/hooks/postdeploy/ does not exist
2024/01/29 18:18:26.975061 [INFO] Finished running scripts in /var/app/current/.platform/hooks/postdeploy
2024/01/29 18:18:26.975070 [INFO] Executing cleanup logic
2024/01/29 18:18:26.977254 [INFO] Platform Engine finished execution on command: self-startup

2024/01/29 18:19:43.318956 [INFO] Starting...
2024/01/29 18:19:43.319063 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 18:19:43.319090 [INFO] reading event message file
2024/01/29 18:19:43.319668 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 18:19:43.494285 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:19:43.890659 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:19:44.286223 [INFO] checking whether command app-deploy is applicable to this instance...
2024/01/29 18:19:44.286236 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 18:19:44.286238 [INFO] Engine command: (app-deploy)

2024/01/29 18:19:44.286243 [INFO] Downloading EB Application...
2024/01/29 18:19:44.286245 [INFO] Region: eu-west-1
2024/01/29 18:19:44.286252 [INFO] envID: e-8gmkc7rmw6
2024/01/29 18:19:44.286254 [INFO] envBucket: elasticbeanstalk-eu-west-1-471947097906
2024/01/29 18:19:44.286257 [INFO] Using manifest file name from command request
2024/01/29 18:19:44.286262 [INFO] Unable to get version manifest file.
2024/01/29 18:19:44.286264 [INFO] Downloading latest manifest available.
2024/01/29 18:19:44.286266 [INFO] Download latest app version manifest
2024/01/29 18:19:44.287005 [INFO] resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest
2024/01/29 18:19:44.384021 [INFO] latestManifest key *: resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706550848895

2024/01/29 18:19:44.384188 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706550848895
2024/01/29 18:19:44.402908 [INFO] Download successful50bytes downloaded
2024/01/29 18:19:44.403045 [INFO] Trying to read and parse version manifest...
2024/01/29 18:19:44.403069 [INFO] Downloading file with path: /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 18:19:44.403104 [INFO] URL: https://elasticbeanstalk-platform-assets-eu-west-1.s3.eu-west-1.amazonaws.com/stalks/eb_docker_amazon_linux_2023_1.0.420.0_20240123011222/sampleapp/EBSampleApp-Docker.zip
2024/01/29 18:19:44.451181 [INFO] Finished download file from https://elasticbeanstalk-platform-assets-eu-west-1.s3.eu-west-1.amazonaws.com/stalks/eb_docker_amazon_linux_2023_1.0.420.0_20240123011222/sampleapp/EBSampleApp-Docker.zip
2024/01/29 18:19:44.452937 [INFO] Executing instruction: ElectLeader
2024/01/29 18:19:44.452944 [INFO] Running leader election for instance i-0282a50a922b1a2c4...
2024/01/29 18:19:44.452947 [INFO] Calling the cfn-elect-cmd-leader to elect the command leader.
2024/01/29 18:19:44.452959 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-elect-cmd-leader --stack arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 --command-name ElasticBeanstalkCommand-AWSEBAutoScalingGroup --invocation-id 67e2569b-98ec-4c5b-a7c4-ebd5a0f0b180 --listener-id i-0282a50a922b1a2c4 --region eu-west-1
2024/01/29 18:19:44.876754 [INFO] Instance is Leader.
2024/01/29 18:19:44.876788 [INFO] Executing instruction: stopSqsd
2024/01/29 18:19:44.876793 [INFO] This is a web server environment instance, skip stop sqsd daemon ...
2024/01/29 18:19:44.876796 [INFO] Executing instruction: PreBuildEbExtension
2024/01/29 18:19:44.876799 [INFO] Starting executing the config set Infra-EmbeddedPreBuild.
2024/01/29 18:19:44.876822 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPreBuild
2024/01/29 18:19:45.322847 [INFO] Finished executing the config set Infra-EmbeddedPreBuild.

2024/01/29 18:19:45.322872 [INFO] Executing instruction: StagedockerApplication
2024/01/29 18:19:45.322887 [INFO] Running command /bin/sh -c docker ps -a -q -f status=running
2024/01/29 18:19:45.342073 [INFO] eb858debfb6a

2024/01/29 18:19:45.342096 [INFO] Pruning containers ...
2024/01/29 18:19:45.342106 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:19:45.367956 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED              STATUS              PORTS      NAMES
eb858debfb6a   ca5fa1deae93   "python /tmp/applica…"   About a minute ago   Up About a minute   8000/tcp   nostalgic_keller

2024/01/29 18:19:45.367988 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 18:19:45.397040 [INFO] Total reclaimed space: 0B

2024/01/29 18:19:45.397069 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:19:45.416316 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED              STATUS              PORTS      NAMES
eb858debfb6a   ca5fa1deae93   "python /tmp/applica…"   About a minute ago   Up About a minute   8000/tcp   nostalgic_keller

2024/01/29 18:19:45.416514 [INFO] Cleanup images ...
2024/01/29 18:19:45.416528 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:19:45.436112 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED              SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   About a minute ago   998MB

2024/01/29 18:19:45.436144 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/29 18:19:45.473238 [INFO] Error response from daemon: conflict: unable to delete ca5fa1deae93 (cannot be forced) - image is being used by running container eb858debfb6a

2024/01/29 18:19:45.473276 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:19:45.492820 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED              SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   About a minute ago   998MB

2024/01/29 18:19:45.493137 [INFO] Running command /bin/sh -c /bin/file -m /opt/elasticbeanstalk/config/private/beanstalk-magic -b --mime-type /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 18:19:45.499774 [INFO] application/zip

2024/01/29 18:19:45.499791 [INFO] app source bundle is zip file ...
2024/01/29 18:19:45.499795 [INFO] extracting /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/
2024/01/29 18:19:45.499805 [INFO] Running command /bin/sh -c /usr/bin/unzip -q -o /opt/elasticbeanstalk/deployment/app_source_bundle -d /var/app/staging/
2024/01/29 18:19:45.505286 [INFO] finished extracting /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/ successfully
2024/01/29 18:19:45.505297 [INFO] Executing instruction: RunAppDeployPreBuildHooks
2024/01/29 18:19:45.505371 [INFO] Executing platform hooks in .platform/hooks/prebuild/
2024/01/29 18:19:45.505389 [INFO] The dir .platform/hooks/prebuild/ does not exist
2024/01/29 18:19:45.505391 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/prebuild
2024/01/29 18:19:45.505396 [INFO] Executing instruction: Generate environment file
2024/01/29 18:19:45.505425 [INFO] Executing instruction: Docker Specific Build Application
2024/01/29 18:19:45.505428 [INFO] start build docker app
2024/01/29 18:19:45.505544 [INFO] fetching image names from Dockerfile /var/app/staging/Dockerfile
2024/01/29 18:19:45.505582 [INFO] found images [public.ecr.aws/docker/library/python:3.8] in Dockerfile /var/app/staging/Dockerfile
2024/01/29 18:19:45.505587 [INFO] pull docker image if update is not false in Dockerrun.aws.json
2024/01/29 18:19:45.505589 [INFO] start to build docker image
2024/01/29 18:19:45.505602 [INFO] Running command /bin/sh -c docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/29 18:19:46.681382 [INFO] #0 building with "default" instance using docker driver

#1 [internal] load .dockerignore
#1 transferring context: 2B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 267B 0.0s done
#2 DONE 0.0s

#3 [internal] load metadata for public.ecr.aws/docker/library/python:3.8
#3 DONE 0.7s

#4 [1/2] FROM public.ecr.aws/docker/library/python:3.8@sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 85B done
#5 DONE 0.0s

#6 [2/2] ADD application.py /tmp/application.py
#6 CACHED

#7 exporting to image
#7 exporting layers done
#7 writing image sha256:ca5fa1deae93591be22dafa0525dc72c8a62a15dfd86bbcc40bc9bfde967b94d done
#7 naming to docker.io/aws_beanstalk/staging-app done
#7 DONE 0.0s

2024/01/29 18:19:46.681406 [INFO] successfully execute command: docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/29 18:19:46.681411 [INFO] successfully build docker image
2024/01/29 18:19:46.681414 [INFO] save staging docker image id
2024/01/29 18:19:46.681425 [INFO] Running command /bin/sh -c docker images aws_beanstalk/staging-app -q
2024/01/29 18:19:46.710560 [INFO] ca5fa1deae93

2024/01/29 18:19:46.710685 [INFO] Executing instruction: configure X-Ray
2024/01/29 18:19:46.710691 [INFO] X-Ray is not enabled.
2024/01/29 18:19:46.710694 [INFO] Executing instruction: configure proxy Nginx
2024/01/29 18:19:46.716552 [INFO] Executing instruction: configure healthd specific proxy conf
2024/01/29 18:19:46.718242 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:19:46.730890 [WARN] Warning: process healthd is already registered...
Deregistering the process ...
2024/01/29 18:19:46.730918 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:19:46.741554 [INFO] Running command /bin/sh -c systemctl is-active healthd.service
2024/01/29 18:19:46.749718 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:19:46.763429 [INFO] Running command /bin/sh -c systemctl stop healthd.service
2024/01/29 18:19:46.837482 [INFO] Running command /bin/sh -c systemctl disable healthd.service
2024/01/29 18:19:47.251498 [INFO] Removed "/etc/systemd/system/multi-user.target.wants/healthd.service".

2024/01/29 18:19:47.251680 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:19:47.633128 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:19:47.650888 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:19:48.038781 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:19:48.047327 [INFO] Running command /bin/sh -c systemctl is-enabled aws-eb.target
2024/01/29 18:19:48.055451 [INFO] Running command /bin/sh -c systemctl enable aws-eb.target
2024/01/29 18:19:48.346887 [INFO] Running command /bin/sh -c systemctl start aws-eb.target
2024/01/29 18:19:48.356876 [INFO] Running command /bin/sh -c systemctl enable healthd.service
2024/01/29 18:19:48.685168 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/healthd.service → /etc/systemd/system/healthd.service.

2024/01/29 18:19:48.685204 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:19:48.697571 [INFO] Running command /bin/sh -c systemctl is-active healthd.service
2024/01/29 18:19:48.706262 [INFO] Running command /bin/sh -c systemctl start healthd.service
2024/01/29 18:19:48.800229 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_logformat.conf to /var/proxy/staging/nginx/conf.d/healthd_logformat.conf
2024/01/29 18:19:48.803421 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_nginx.conf to /var/proxy/staging/nginx/conf.d/elasticbeanstalk/healthd.conf
2024/01/29 18:19:48.804252 [INFO] Executing instruction: configure log streaming
2024/01/29 18:19:48.804263 [INFO] log streaming is not enabled
2024/01/29 18:19:48.804266 [INFO] disable log stream
2024/01/29 18:19:48.804298 [INFO] Running command /bin/sh -c systemctl show -p PartOf amazon-cloudwatch-agent.service
2024/01/29 18:19:48.822455 [INFO] Running command /bin/sh -c systemctl stop amazon-cloudwatch-agent.service
2024/01/29 18:19:48.841779 [INFO] Executing instruction: GetToggleForceRotate
2024/01/29 18:19:48.841804 [INFO] Checking if logs need forced rotation
2024/01/29 18:19:48.841823 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:19:49.379335 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:19:49.829800 [INFO] Procfile not found. Generating default rsyslog config
2024/01/29 18:19:49.831720 [INFO] Running command /bin/sh -c systemctl restart rsyslog.service
2024/01/29 18:19:50.075621 [INFO] Executing instruction: Configure Docker Logging
2024/01/29 18:19:50.093008 [INFO] Executing instruction: PostBuildEbExtension
2024/01/29 18:19:50.093024 [INFO] Starting executing the config set Infra-EmbeddedPostBuild.
2024/01/29 18:19:50.093035 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPostBuild
2024/01/29 18:19:50.437194 [INFO] Finished executing the config set Infra-EmbeddedPostBuild.

2024/01/29 18:19:50.437240 [INFO] Executing instruction: CleanEbExtensions
2024/01/29 18:19:50.437262 [INFO] Cleaned ebextensions subdirectories from app staging directory.
2024/01/29 18:19:50.437265 [INFO] Executing instruction: RunAppDeployPreDeployHooks
2024/01/29 18:19:50.437289 [INFO] Executing platform hooks in .platform/hooks/predeploy/
2024/01/29 18:19:50.437300 [INFO] The dir .platform/hooks/predeploy/ does not exist
2024/01/29 18:19:50.437303 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/predeploy
2024/01/29 18:19:50.437308 [INFO] Executing instruction: stop X-Ray
2024/01/29 18:19:50.437311 [INFO] stop X-Ray ...
2024/01/29 18:19:50.437320 [INFO] Running command /bin/sh -c systemctl show -p PartOf xray.service
2024/01/29 18:19:50.449441 [WARN] stopProcess Warning: process xray is not registered 
2024/01/29 18:19:50.449549 [INFO] Running command /bin/sh -c systemctl stop xray.service
2024/01/29 18:19:50.462431 [INFO] Executing instruction: Run Docker Container
2024/01/29 18:19:50.462515 [INFO] stop currently running containers...
2024/01/29 18:19:50.462533 [INFO] detected old app is not docker compose app
2024/01/29 18:19:50.462547 [INFO] Running command /bin/sh -c iptables-save | grep -v added_by_elasticbeanstalk | iptables-restore
2024/01/29 18:19:50.530529 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:19:50.546603 [INFO] Running command /bin/sh -c systemctl is-active nginx.service
2024/01/29 18:19:50.557125 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:19:50.569484 [INFO] Running command /bin/sh -c systemctl stop nginx.service
2024/01/29 18:19:50.698733 [INFO] Running command /bin/sh -c systemctl disable nginx.service
2024/01/29 18:19:51.018337 [INFO] Removed "/etc/systemd/system/multi-user.target.wants/nginx.service".

2024/01/29 18:19:51.018538 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:19:51.307983 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:19:51.325598 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:19:51.337216 [INFO] Running command /bin/sh -c systemctl is-active eb-docker.service
2024/01/29 18:19:51.345456 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:19:51.355490 [INFO] Running command /bin/sh -c systemctl stop eb-docker.service
2024/01/29 18:20:01.901225 [INFO] Running command /bin/sh -c systemctl disable eb-docker.service
2024/01/29 18:20:02.390341 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:20:02.698709 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:20:02.722495 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/29 18:20:02.738083 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-log.service
2024/01/29 18:20:02.747751 [INFO] Running command /bin/sh -c systemctl disable eb-docker-log.service
2024/01/29 18:20:03.126092 [INFO] Removed "/etc/systemd/system/eb-docker.service.wants/eb-docker-log.service".

2024/01/29 18:20:03.126203 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:20:03.495408 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:20:03.507880 [INFO] stopping current container: eb858debfb6a
2024/01/29 18:20:03.507908 [INFO] Running command /bin/sh -c docker ps | grep -q eb858debfb6a
2024/01/29 18:20:03.536834 [INFO] Running command /bin/sh -c docker ps | grep -q eb858debfb6a
2024/01/29 18:20:03.572691 [INFO] Pruning containers ...
2024/01/29 18:20:03.572715 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:20:03.592899 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED              STATUS                       PORTS     NAMES
eb858debfb6a   ca5fa1deae93   "python /tmp/applica…"   About a minute ago   Exited (137) 2 seconds ago             nostalgic_keller

2024/01/29 18:20:03.592940 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 18:20:03.624128 [INFO] Deleted Containers:
eb858debfb6ad7fbba431ca7ad177a67c09ba67f597c5b07fa57d0bdc9de0e8e

Total reclaimed space: 1.449MB

2024/01/29 18:20:03.624154 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:20:03.657959 [INFO] CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

2024/01/29 18:20:03.657993 [INFO] Running command /bin/sh -c docker rmi aws_beanstalk/current-app
2024/01/29 18:20:03.705826 [INFO] Untagged: aws_beanstalk/current-app:latest

2024/01/29 18:20:03.705846 [INFO] Removing /var/app/current/ if it exists
2024/01/29 18:20:03.706943 [INFO] Renaming /var/app/staging/ to /var/app/current/
2024/01/29 18:20:03.707041 [INFO] detected new app is not docker compose app
2024/01/29 18:20:03.707630 [INFO] Running command /bin/sh -c docker run -d --env-file /opt/elasticbeanstalk/deployment/env.list -v /var/log/eb-docker/containers/eb-current-app:/tmp/sample-app  ca5fa1deae93 
2024/01/29 18:20:04.239252 [INFO] f94f9426cbb689afec0f5842981764b7f05bd467bdfbef4a5890d40d450ae5fa

2024/01/29 18:20:09.239559 [INFO] Running command /bin/sh -c docker ps | grep -q f94f9426cbb6
2024/01/29 18:20:09.290688 [INFO] Clear existing beanstalk iptables rules...
2024/01/29 18:20:09.290935 [INFO] Running command /bin/sh -c iptables-save | grep -v added_by_elasticbeanstalk | iptables-restore
2024/01/29 18:20:09.330721 [INFO] Getting container info...
2024/01/29 18:20:09.330760 [INFO] Running command /bin/sh -c docker inspect f94f9426cbb689afec0f5842981764b7f05bd467bdfbef4a5890d40d450ae5fa

2024/01/29 18:20:09.368406 [INFO] Running command /bin/sh -c ip route show default | awk '{print $5}'
2024/01/29 18:20:09.373037 [INFO] ens5

2024/01/29 18:20:09.373072 [INFO] Writing nginx upstream config...
2024/01/29 18:20:09.375376 [INFO] Running command /bin/sh -c /usr/sbin/nginx -t -c /var/proxy/staging/nginx/nginx.conf
2024/01/29 18:20:09.391220 [INFO] nginx: [warn] could not build optimal types_hash, you should increase either types_hash_max_size: 1024 or types_hash_bucket_size: 64; ignoring types_hash_bucket_size
nginx: the configuration file /var/proxy/staging/nginx/nginx.conf syntax is ok
nginx: configuration file /var/proxy/staging/nginx/nginx.conf test is successful

2024/01/29 18:20:09.391433 [INFO] Running command /bin/sh -c cp -rp /var/proxy/staging/nginx/* /etc/nginx
2024/01/29 18:20:09.394252 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:20:09.408374 [INFO] register process nginx
2024/01/29 18:20:09.408402 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:20:09.423290 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:20:09.718681 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:20:09.727412 [INFO] Running command /bin/sh -c systemctl enable nginx.service
2024/01/29 18:20:10.014025 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service → /usr/lib/systemd/system/nginx.service.

2024/01/29 18:20:10.014063 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:20:10.028776 [INFO] Running command /bin/sh -c systemctl restart nginx.service
2024/01/29 18:20:10.221585 [INFO] Running command /bin/sh -c service iptables save
2024/01/29 18:20:10.264024 [INFO] iptables: Saving firewall rules to /etc/sysconfig/iptables: [  OK  ]

2024/01/29 18:20:10.264039 [INFO] Traffic forward set-up completed.
2024/01/29 18:20:10.264042 [INFO] making STAGING app container current...
2024/01/29 18:20:10.264053 [INFO] Running command /bin/sh -c docker tag ca5fa1deae93 aws_beanstalk/current-app
2024/01/29 18:20:10.287641 [INFO] Running command /bin/sh -c docker rmi aws_beanstalk/staging-app
2024/01/29 18:20:10.315802 [INFO] Untagged: aws_beanstalk/staging-app:latest

2024/01/29 18:20:10.316006 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:20:10.332683 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:20:10.676981 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:20:10.687843 [INFO] Running command /bin/sh -c systemctl enable eb-docker.service
2024/01/29 18:20:11.031646 [INFO] The unit files have no installation config (WantedBy=, RequiredBy=, Also=,
Alias= settings in the [Install] section, and DefaultInstance= for template
units). This means they are not meant to be enabled using systemctl.
 
Possible reasons for having this kind of units are:
• A unit may be statically enabled by being symlinked from another unit's
  .wants/ or .requires/ directory.
• A unit's purpose may be to act as a helper for some other unit which has
  a requirement dependency on it.
• A unit may be started when needed via activation (socket, path, timer,
  D-Bus, udev, scripted systemctl call, ...).
• In case of template units, the unit is meant to be enabled with some
  instance name specified.

2024/01/29 18:20:11.031685 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:20:11.048192 [INFO] Running command /bin/sh -c systemctl is-active eb-docker.service
2024/01/29 18:20:11.058483 [INFO] Running command /bin/sh -c systemctl start eb-docker.service
2024/01/29 18:20:11.151988 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/29 18:20:11.178861 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:20:11.700896 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:20:11.710318 [INFO] Running command /bin/sh -c systemctl enable eb-docker-log.service
2024/01/29 18:20:12.162356 [INFO] Created symlink /etc/systemd/system/eb-docker.service.wants/eb-docker-log.service → /etc/systemd/system/eb-docker-log.service.

2024/01/29 18:20:12.162395 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/29 18:20:12.184083 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-log.service
2024/01/29 18:20:12.193338 [INFO] Running command /bin/sh -c systemctl start eb-docker-log.service
2024/01/29 18:20:12.306656 [INFO] docker container f94f9426cbb6 is running aws_beanstalk/current-app
2024/01/29 18:20:12.306673 [INFO] Cleanup images ...
2024/01/29 18:20:12.306687 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:20:12.332076 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED              SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   About a minute ago   998MB

2024/01/29 18:20:12.332107 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/29 18:20:12.435656 [INFO] Error response from daemon: conflict: unable to delete ca5fa1deae93 (cannot be forced) - image is being used by running container f94f9426cbb6

2024/01/29 18:20:12.435743 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:20:12.475147 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED              SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   About a minute ago   998MB

2024/01/29 18:20:12.475177 [INFO] Executing instruction: start X-Ray
2024/01/29 18:20:12.475184 [INFO] X-Ray is not enabled.
2024/01/29 18:20:12.475188 [INFO] Executing instruction: configureSqsd
2024/01/29 18:20:12.475193 [INFO] This is a web server environment instance, skip configure sqsd daemon ...
2024/01/29 18:20:12.475196 [INFO] Executing instruction: startSqsd
2024/01/29 18:20:12.475200 [INFO] This is a web server environment instance, skip start sqsd daemon ...
2024/01/29 18:20:12.475203 [INFO] Executing instruction: Track pids in healthd
2024/01/29 18:20:12.475207 [INFO] This is an enhanced health env...
2024/01/29 18:20:12.475220 [INFO] Running command /bin/sh -c systemctl show -p ConsistsOf aws-eb.target | cut -d= -f2
2024/01/29 18:20:12.494186 [INFO] eb-docker-log.service eb-docker.service nginx.service eb-docker-events.service cfn-hup.service docker.service healthd.service

2024/01/29 18:20:12.494244 [INFO] Running command /bin/sh -c systemctl show -p ConsistsOf eb-app.target | cut -d= -f2
2024/01/29 18:20:12.507065 [INFO] 

2024/01/29 18:20:12.507801 [INFO] Executing instruction: RunAppDeployPostDeployHooks
2024/01/29 18:20:12.507890 [INFO] Executing platform hooks in .platform/hooks/postdeploy/
2024/01/29 18:20:12.507908 [INFO] The dir .platform/hooks/postdeploy/ does not exist
2024/01/29 18:20:12.507915 [INFO] Finished running scripts in /var/app/current/.platform/hooks/postdeploy
2024/01/29 18:20:12.507922 [INFO] Executing cleanup logic
2024/01/29 18:20:12.508063 [INFO] CommandService Response: {"status":"SUCCESS","api_version":"1.0","results":[{"status":"SUCCESS","msg":"Engine execution has succeeded.","returncode":0,"events":[{"msg":"Instance deployment completed successfully.","timestamp":1706552412507,"severity":"INFO"}]}]}

2024/01/29 18:20:12.508388 [INFO] Platform Engine finished execution on command: app-deploy

2024/01/29 18:21:36.714689 [INFO] Starting...
2024/01/29 18:21:36.714730 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 18:21:36.714886 [INFO] reading event message file
2024/01/29 18:21:36.715056 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 18:21:36.791955 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:21:37.207884 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:21:37.600360 [INFO] checking whether command app-deploy is applicable to this instance...
2024/01/29 18:21:37.600370 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 18:21:37.600373 [INFO] Engine command: (app-deploy)

2024/01/29 18:21:37.600377 [INFO] Downloading EB Application...
2024/01/29 18:21:37.600379 [INFO] Region: eu-west-1
2024/01/29 18:21:37.600381 [INFO] envID: e-8gmkc7rmw6
2024/01/29 18:21:37.600384 [INFO] envBucket: elasticbeanstalk-eu-west-1-471947097906
2024/01/29 18:21:37.600386 [INFO] Using manifest file name from command request
2024/01/29 18:21:37.600391 [INFO] Manifest name is : manifest_1706552475400
2024/01/29 18:21:37.600393 [INFO] Download app version manifest
2024/01/29 18:21:37.600579 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706552475400
2024/01/29 18:21:37.634905 [INFO] Download successful123bytes downloaded
2024/01/29 18:21:37.635023 [INFO] Trying to read and parse version manifest...
2024/01/29 18:21:37.635083 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/_versions/hisab-backend/0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
2024/01/29 18:21:37.647819 [INFO] Download successful264bytes downloaded
2024/01/29 18:21:37.648059 [INFO] Executing instruction: ElectLeader
2024/01/29 18:21:37.648065 [INFO] Running leader election for instance i-0282a50a922b1a2c4...
2024/01/29 18:21:37.648067 [INFO] Calling the cfn-elect-cmd-leader to elect the command leader.
2024/01/29 18:21:37.648081 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-elect-cmd-leader --stack arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 --command-name ElasticBeanstalkCommand-AWSEBAutoScalingGroup --invocation-id 21e260ea-4bb2-464d-a869-42033727fd73 --listener-id i-0282a50a922b1a2c4 --region eu-west-1
2024/01/29 18:21:38.028031 [INFO] Instance is Leader.
2024/01/29 18:21:38.028066 [INFO] Executing instruction: stopSqsd
2024/01/29 18:21:38.028072 [INFO] This is a web server environment instance, skip stop sqsd daemon ...
2024/01/29 18:21:38.028086 [INFO] Executing instruction: PreBuildEbExtension
2024/01/29 18:21:38.028088 [INFO] Starting executing the config set Infra-EmbeddedPreBuild.
2024/01/29 18:21:38.028112 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPreBuild
2024/01/29 18:21:38.462768 [INFO] Finished executing the config set Infra-EmbeddedPreBuild.

2024/01/29 18:21:38.462789 [INFO] Executing instruction: StagedockerApplication
2024/01/29 18:21:38.462802 [INFO] Running command /bin/sh -c docker ps -a -q -f status=running
2024/01/29 18:21:38.509041 [INFO] f94f9426cbb6

2024/01/29 18:21:38.509061 [INFO] Pruning containers ...
2024/01/29 18:21:38.509073 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:21:38.528297 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED              STATUS              PORTS      NAMES
f94f9426cbb6   ca5fa1deae93   "python /tmp/applica…"   About a minute ago   Up About a minute   8000/tcp   thirsty_mendel

2024/01/29 18:21:38.528342 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 18:21:38.544950 [INFO] Total reclaimed space: 0B

2024/01/29 18:21:38.544992 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:21:38.571787 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED              STATUS              PORTS      NAMES
f94f9426cbb6   ca5fa1deae93   "python /tmp/applica…"   About a minute ago   Up About a minute   8000/tcp   thirsty_mendel

2024/01/29 18:21:38.571993 [INFO] Cleanup images ...
2024/01/29 18:21:38.572039 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:21:38.605067 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED         SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   3 minutes ago   998MB

2024/01/29 18:21:38.605095 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/29 18:21:38.641129 [INFO] Error response from daemon: conflict: unable to delete ca5fa1deae93 (cannot be forced) - image is being used by running container f94f9426cbb6

2024/01/29 18:21:38.641151 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 18:21:38.658810 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED         SIZE
aws_beanstalk/current-app   latest    ca5fa1deae93   3 minutes ago   998MB

2024/01/29 18:21:38.659147 [INFO] Running command /bin/sh -c /bin/file -m /opt/elasticbeanstalk/config/private/beanstalk-magic -b --mime-type /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 18:21:38.661718 [INFO] application/json

2024/01/29 18:21:38.661740 [INFO] Running command /bin/sh -c docker compose -f /opt/elasticbeanstalk/deployment/app_source_bundle config -q
2024/01/29 18:21:39.054880 [INFO] validating /opt/elasticbeanstalk/deployment/app_source_bundle: (root) Additional property AWSEBDockerrunVersion is not allowed

2024/01/29 18:21:39.055079 [INFO] Copying file /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/Dockerrun.aws.json
2024/01/29 18:21:39.058957 [INFO] Executing instruction: RunAppDeployPreBuildHooks
2024/01/29 18:21:39.058993 [INFO] Executing platform hooks in .platform/hooks/prebuild/
2024/01/29 18:21:39.059016 [INFO] The dir .platform/hooks/prebuild/ does not exist
2024/01/29 18:21:39.059019 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/prebuild
2024/01/29 18:21:39.059024 [INFO] Executing instruction: Generate environment file
2024/01/29 18:21:39.059089 [INFO] Executing instruction: Docker Specific Build Application
2024/01/29 18:21:39.059094 [INFO] start build docker app
2024/01/29 18:21:39.059562 [INFO] generate dockerfile with the image and ports from Dockerrun.aws.json
2024/01/29 18:21:39.059573 [INFO] fetching image and ports
2024/01/29 18:21:39.061734 [INFO] fetching image names from Dockerfile /var/app/staging/Dockerfile
2024/01/29 18:21:39.061813 [INFO] found images [471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf] in Dockerfile /var/app/staging/Dockerfile
2024/01/29 18:21:39.061827 [INFO] authenticate with ECR if the image is in an ECR repo
2024/01/29 18:21:39.061836 [INFO] Running command /bin/sh -c aws ecr get-login-password --region eu-west-1 | docker login --username AWS --password-stdin 471947097906.dkr.ecr.eu-west-1.amazonaws.com
2024/01/29 18:21:40.766846 [INFO] Login Succeeded

2024/01/29 18:21:40.767532 [INFO] WARNING! Your password will be stored unencrypted in /root/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store


2024/01/29 18:21:40.767540 [INFO] pull docker image if update is not false in Dockerrun.aws.json
2024/01/29 18:21:40.767559 [INFO] Running command /bin/sh -c docker pull 471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
2024/01/29 18:22:02.892866 [INFO] 0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf: Pulling from hisab-backend/hisab-backend
1b13d4e1a46e: Already exists
1c74526957fc: Already exists
30d855997954: Already exists
223fb869183b: Pulling fs layer
3bc4c1e5efad: Pulling fs layer
c516ddd64fde: Pulling fs layer
4f4fb700ef54: Pulling fs layer
0132eec3e70e: Pulling fs layer
11634160b591: Pulling fs layer
4b58255b99c8: Pulling fs layer
68505da3a96f: Pulling fs layer
758cc59e712d: Pulling fs layer
4f4fb700ef54: Waiting
0132eec3e70e: Waiting
11634160b591: Waiting
4b58255b99c8: Waiting
68505da3a96f: Waiting
758cc59e712d: Waiting
c516ddd64fde: Verifying Checksum
c516ddd64fde: Download complete
4f4fb700ef54: Verifying Checksum
4f4fb700ef54: Download complete
0132eec3e70e: Verifying Checksum
0132eec3e70e: Download complete
11634160b591: Verifying Checksum
11634160b591: Download complete
3bc4c1e5efad: Verifying Checksum
3bc4c1e5efad: Download complete
68505da3a96f: Verifying Checksum
68505da3a96f: Download complete
223fb869183b: Verifying Checksum
223fb869183b: Download complete
4b58255b99c8: Verifying Checksum
4b58255b99c8: Download complete
758cc59e712d: Verifying Checksum
758cc59e712d: Download complete
223fb869183b: Pull complete
3bc4c1e5efad: Pull complete
c516ddd64fde: Pull complete
4f4fb700ef54: Pull complete
0132eec3e70e: Pull complete
11634160b591: Pull complete
4b58255b99c8: Pull complete
68505da3a96f: Pull complete
758cc59e712d: Pull complete
Digest: sha256:7a44ee41fb908108cafc86108369a035f2a47361e92f296cd58d2990a7d51e6e
Status: Downloaded newer image for 471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf

2024/01/29 18:22:02.893761 [INFO] successfully execute command: docker pull 471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
2024/01/29 18:22:02.894358 [INFO] successfully pulled docker image 471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
2024/01/29 18:22:02.894943 [INFO] start to build docker image
2024/01/29 18:22:02.896425 [INFO] Running command /bin/sh -c docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/29 18:22:03.790957 [INFO] #0 building with "default" instance using docker driver

#1 [internal] load .dockerignore
#1 transferring context: 2B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 218B done
#2 DONE 0.0s

#3 [internal] load metadata for 471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
#3 DONE 0.0s

#4 [1/1] FROM 471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:0f54a29e1a1bda2f34f2d88168096a93f4c5e0cf
#4 DONE 0.2s

#5 exporting to image
#5 exporting layers done
#5 writing image sha256:940deb31ba2b03be74f5f1f06af83da22dca2fdbfa5cd695269f335a909a1698 done
#5 naming to docker.io/aws_beanstalk/staging-app done
#5 DONE 0.0s

2024/01/29 18:22:03.790979 [INFO] successfully execute command: docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/29 18:22:03.790990 [INFO] successfully build docker image
2024/01/29 18:22:03.790993 [INFO] save staging docker image id
2024/01/29 18:22:03.791011 [INFO] Running command /bin/sh -c docker images aws_beanstalk/staging-app -q
2024/01/29 18:22:03.819408 [INFO] 940deb31ba2b

2024/01/29 18:22:03.820894 [INFO] Executing instruction: configure X-Ray
2024/01/29 18:22:03.820905 [INFO] X-Ray is not enabled.
2024/01/29 18:22:03.820908 [INFO] Executing instruction: configure proxy Nginx
2024/01/29 18:22:03.838713 [INFO] Executing instruction: configure healthd specific proxy conf
2024/01/29 18:22:03.840688 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:22:03.893062 [WARN] Warning: process healthd is already registered...
Deregistering the process ...
2024/01/29 18:22:03.893090 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:22:03.905749 [INFO] Running command /bin/sh -c systemctl is-active healthd.service
2024/01/29 18:22:03.914108 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:22:03.923667 [INFO] Running command /bin/sh -c systemctl stop healthd.service
2024/01/29 18:22:04.033978 [INFO] Running command /bin/sh -c systemctl disable healthd.service
2024/01/29 18:22:04.431119 [INFO] Removed "/etc/systemd/system/multi-user.target.wants/healthd.service".

2024/01/29 18:22:04.438966 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:22:04.732331 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:22:04.748860 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:22:05.094817 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:22:05.103175 [INFO] Running command /bin/sh -c systemctl is-enabled aws-eb.target
2024/01/29 18:22:05.113662 [INFO] Running command /bin/sh -c systemctl enable aws-eb.target
2024/01/29 18:22:05.404845 [INFO] Running command /bin/sh -c systemctl start aws-eb.target
2024/01/29 18:22:05.426305 [INFO] Running command /bin/sh -c systemctl enable healthd.service
2024/01/29 18:22:05.746779 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/healthd.service → /etc/systemd/system/healthd.service.

2024/01/29 18:22:05.746819 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/29 18:22:05.767060 [INFO] Running command /bin/sh -c systemctl is-active healthd.service
2024/01/29 18:22:05.788686 [INFO] Running command /bin/sh -c systemctl start healthd.service
2024/01/29 18:22:05.888700 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_logformat.conf to /var/proxy/staging/nginx/conf.d/healthd_logformat.conf
2024/01/29 18:22:05.889643 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_nginx.conf to /var/proxy/staging/nginx/conf.d/elasticbeanstalk/healthd.conf
2024/01/29 18:22:05.890644 [INFO] Executing instruction: configure log streaming
2024/01/29 18:22:05.890652 [INFO] log streaming is not enabled
2024/01/29 18:22:05.890654 [INFO] disable log stream
2024/01/29 18:22:05.890664 [INFO] Running command /bin/sh -c systemctl show -p PartOf amazon-cloudwatch-agent.service
2024/01/29 18:22:05.909958 [INFO] Running command /bin/sh -c systemctl stop amazon-cloudwatch-agent.service
2024/01/29 18:22:05.929350 [INFO] Executing instruction: GetToggleForceRotate
2024/01/29 18:22:05.929372 [INFO] Checking if logs need forced rotation
2024/01/29 18:22:05.929393 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:22:06.757175 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:22:07.302546 [INFO] Procfile not found. Generating default rsyslog config
2024/01/29 18:22:07.311216 [INFO] Running command /bin/sh -c systemctl restart rsyslog.service
2024/01/29 18:22:07.831764 [INFO] Executing instruction: Configure Docker Logging
2024/01/29 18:22:07.851239 [INFO] Executing instruction: PostBuildEbExtension
2024/01/29 18:22:07.851264 [INFO] Starting executing the config set Infra-EmbeddedPostBuild.
2024/01/29 18:22:07.851282 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPostBuild
2024/01/29 18:22:08.345136 [INFO] Finished executing the config set Infra-EmbeddedPostBuild.

2024/01/29 18:22:08.345160 [INFO] Executing instruction: CleanEbExtensions
2024/01/29 18:22:08.345184 [INFO] Cleaned ebextensions subdirectories from app staging directory.
2024/01/29 18:22:08.345188 [INFO] Executing instruction: RunAppDeployPreDeployHooks
2024/01/29 18:22:08.345214 [INFO] Executing platform hooks in .platform/hooks/predeploy/
2024/01/29 18:22:08.345228 [INFO] The dir .platform/hooks/predeploy/ does not exist
2024/01/29 18:22:08.345231 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/predeploy
2024/01/29 18:22:08.345236 [INFO] Executing instruction: stop X-Ray
2024/01/29 18:22:08.345240 [INFO] stop X-Ray ...
2024/01/29 18:22:08.345251 [INFO] Running command /bin/sh -c systemctl show -p PartOf xray.service
2024/01/29 18:22:08.359272 [WARN] stopProcess Warning: process xray is not registered 
2024/01/29 18:22:08.359303 [INFO] Running command /bin/sh -c systemctl stop xray.service
2024/01/29 18:22:08.374269 [INFO] Executing instruction: Run Docker Container
2024/01/29 18:22:08.374297 [INFO] stop currently running containers...
2024/01/29 18:22:08.374322 [INFO] detected old app is not docker compose app
2024/01/29 18:22:08.374340 [INFO] Running command /bin/sh -c iptables-save | grep -v added_by_elasticbeanstalk | iptables-restore
2024/01/29 18:22:08.430649 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:22:08.442212 [INFO] Running command /bin/sh -c systemctl is-active nginx.service
2024/01/29 18:22:08.449694 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/29 18:22:08.458752 [INFO] Running command /bin/sh -c systemctl stop nginx.service
2024/01/29 18:22:08.620298 [INFO] Running command /bin/sh -c systemctl disable nginx.service
2024/01/29 18:22:08.958211 [INFO] Removed "/etc/systemd/system/multi-user.target.wants/nginx.service".

2024/01/29 18:22:08.961611 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:22:09.255386 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:22:09.264611 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:22:09.279196 [INFO] Running command /bin/sh -c systemctl is-active eb-docker.service
2024/01/29 18:22:09.287785 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/29 18:22:09.300169 [INFO] Running command /bin/sh -c systemctl stop eb-docker.service
2024/01/29 18:22:19.819732 [INFO] Running command /bin/sh -c systemctl disable eb-docker.service
2024/01/29 18:22:20.141443 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:22:20.426707 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:22:20.436510 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/29 18:22:20.449833 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-log.service
2024/01/29 18:22:20.458368 [INFO] Running command /bin/sh -c systemctl disable eb-docker-log.service
2024/01/29 18:22:20.740077 [INFO] Removed "/etc/systemd/system/eb-docker.service.wants/eb-docker-log.service".

2024/01/29 18:22:20.740208 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/29 18:22:21.073525 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/29 18:22:21.083196 [INFO] stopping current container: f94f9426cbb6
2024/01/29 18:22:21.083227 [INFO] Running command /bin/sh -c docker ps | grep -q f94f9426cbb6
2024/01/29 18:22:21.105100 [INFO] Running command /bin/sh -c docker ps | grep -q f94f9426cbb6
2024/01/29 18:22:21.144295 [INFO] Pruning containers ...
2024/01/29 18:22:21.144364 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:22:21.168175 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS                      PORTS     NAMES
f94f9426cbb6   ca5fa1deae93   "python /tmp/applica…"   2 minutes ago   Exited (137) 1 second ago             thirsty_mendel

2024/01/29 18:22:21.168203 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 18:22:21.209847 [INFO] Deleted Containers:
f94f9426cbb689afec0f5842981764b7f05bd467bdfbef4a5890d40d450ae5fa

Total reclaimed space: 1.449MB

2024/01/29 18:22:21.209870 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 18:22:21.233843 [INFO] CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

2024/01/29 18:22:21.233874 [INFO] Running command /bin/sh -c docker rmi aws_beanstalk/current-app
2024/01/29 18:22:21.258996 [INFO] Untagged: aws_beanstalk/current-app:latest
Deleted: sha256:ca5fa1deae93591be22dafa0525dc72c8a62a15dfd86bbcc40bc9bfde967b94d

2024/01/29 18:22:21.259022 [INFO] Removing /var/app/current/ if it exists
2024/01/29 18:22:21.259216 [INFO] Renaming /var/app/staging/ to /var/app/current/
2024/01/29 18:22:21.259238 [INFO] detected new app is not docker compose app
2024/01/29 18:22:21.259295 [INFO] Running command /bin/sh -c docker run -d --env-file /opt/elasticbeanstalk/deployment/env.list   940deb31ba2b 
2024/01/29 18:22:22.080152 [INFO] 5c117c828ccfbdee493ff579ec209b431827dffd9dc7513adec1dc0ec02937f9

2024/01/29 18:22:22.080177 [INFO] docker: Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: "./main --environment prod": stat ./main --environment prod: no such file or directory: unknown.

2024/01/29 18:22:22.080192 [ERROR] An error occurred during execution of command [app-deploy] - [Run Docker Container]. Stop running the command. Error: failed to run docker container: Command /bin/sh -c docker run -d --env-file /opt/elasticbeanstalk/deployment/env.list   940deb31ba2b  failed with error exit status 127. Stderr:docker: Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: "./main --environment prod": stat ./main --environment prod: no such file or directory: unknown.
 

2024/01/29 18:22:22.080196 [INFO] Executing cleanup logic
2024/01/29 18:22:22.081603 [INFO] CommandService Response: {"status":"FAILURE","api_version":"1.0","results":[{"status":"FAILURE","msg":"Engine execution has encountered an error.","returncode":1,"events":[{"msg":"Instance deployment failed to start the Docker container. The deployment failed.","timestamp":1706552542080,"severity":"ERROR"},{"msg":"Instance deployment failed. For details, see 'eb-engine.log'.","timestamp":1706552542080,"severity":"ERROR"}]}]}

2024/01/29 18:22:22.082371 [INFO] Platform Engine finished execution on command: app-deploy

2024/01/29 18:23:12.743367 [INFO] Starting...
2024/01/29 18:23:12.743404 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 18:23:12.743424 [INFO] reading event message file
2024/01/29 18:23:12.746054 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 18:23:12.894024 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 18:23:13.356400 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/e739e470-bed0-11ee-9627-0a7a22b9c067 -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 18:23:13.869072 [INFO] checking whether command bundle-log is applicable to this instance...
2024/01/29 18:23:13.869085 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 18:23:13.869088 [INFO] Engine command: (bundle-log)

2024/01/29 18:23:13.870386 [INFO] Executing instruction: GetBundleLogs
2024/01/29 18:23:13.870396 [INFO] Bundle Logs...
