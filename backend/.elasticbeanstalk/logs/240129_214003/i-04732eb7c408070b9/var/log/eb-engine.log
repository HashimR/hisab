2024/01/27 13:31:39.883804 [INFO] Starting...
2024/01/27 13:31:39.883852 [INFO] Starting EBPlatform-PlatformEngine
2024/01/27 13:31:39.883943 [INFO] reading event message file
2024/01/27 13:31:39.884825 [INFO] Engine received EB command userdata-exec

2024/01/27 13:31:39.904072 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/27 13:31:40.789512 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/27 13:31:41.725893 [INFO] This is a workflow controlled instance.
2024/01/27 13:31:41.725975 [INFO] Engine command: (env-launch)

2024/01/27 13:31:41.726435 [INFO] Executing instruction: SyncClock
2024/01/27 13:31:41.726439 [INFO] Starting SyncClock
2024/01/27 13:31:41.726457 [INFO] Running command /bin/sh -c /usr/bin/chronyc tracking
2024/01/27 13:31:41.733748 [INFO] Reference ID    : A9FEA97B (169.254.169.123)
Stratum         : 4
Ref time (UTC)  : Sat Jan 27 13:31:40 2024
System time     : 0.000170581 seconds fast of NTP time
Last offset     : +0.000273690 seconds
RMS offset      : 0.000273690 seconds
Frequency       : 9.576 ppm slow
Residual freq   : -31.348 ppm
Skew            : 4.620 ppm
Root delay      : 0.000741179 seconds
Root dispersion : 0.000557624 seconds
Update interval : 1.8 seconds
Leap status     : Normal

2024/01/27 13:31:41.733772 [INFO] Running command /bin/sh -c /usr/bin/chronyc -a makestep
2024/01/27 13:31:41.738764 [INFO] 200 OK

2024/01/27 13:31:41.738825 [INFO] Skipping Configure OS
2024/01/27 13:31:41.738832 [INFO] Skipping LockRepo
2024/01/27 13:31:41.738838 [INFO] Skipping GenerateEBBanner
2024/01/27 13:31:41.738843 [INFO] Skipping Install Process Manager
2024/01/27 13:31:41.738848 [INFO] Skipping install syslog
2024/01/27 13:31:41.738853 [INFO] Skipping install cron
2024/01/27 13:31:41.738858 [INFO] Skipping install proxy
2024/01/27 13:31:41.738863 [INFO] Skipping installhealthd
2024/01/27 13:31:41.738869 [INFO] Skipping Install Log Streaming Manager
2024/01/27 13:31:41.738874 [INFO] Skipping install X-Ray
2024/01/27 13:31:41.738879 [INFO] Skipping install Third Party License
2024/01/27 13:31:41.738885 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:41.738889 [INFO] Executing instruction: installSqsd
2024/01/27 13:31:41.738892 [INFO] This is a web server environment instance, skip install sqsd daemon ...
2024/01/27 13:31:41.738897 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:41.738900 [INFO] Executing instruction: bootstraphealthd
2024/01/27 13:31:41.738904 [INFO] this is an enhanced health env ...
2024/01/27 13:31:41.738916 [INFO] bootstrap healthd....
2024/01/27 13:31:41.738930 [INFO] Running command /bin/sh -c /usr/bin/id -u healthd || /usr/sbin/useradd --user-group healthd -s /sbin/nologin --create-home
2024/01/27 13:31:42.399711 [INFO] /usr/bin/id: ‘healthd’: no such user

2024/01/27 13:31:42.401585 [INFO] none proxy, skip creating proxy dir for healthd
2024/01/27 13:31:42.401604 [INFO] bootstrap healthd....
2024/01/27 13:31:42.401622 [INFO] Running command /bin/sh -c /usr/bin/id -u healthd || /usr/sbin/useradd --user-group healthd -s /sbin/nologin --create-home
2024/01/27 13:31:42.406055 [INFO] 1001

2024/01/27 13:31:42.407598 [INFO] configure bundle log for healthd...
2024/01/27 13:31:42.407696 [INFO] Skipping Install yum packages
2024/01/27 13:31:42.407703 [INFO] Skipping install docker-compose
2024/01/27 13:31:42.407708 [INFO] Skipping Configure Docker Daemon
2024/01/27 13:31:42.407731 [INFO] Skipping MarkBaked
2024/01/27 13:31:42.407738 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:42.407741 [INFO] Executing instruction: TuneSystemSettings
2024/01/27 13:31:42.407744 [INFO] Starting TuneSystemSettings
2024/01/27 13:31:42.407749 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:42.408752 [INFO] Executing instruction: GetSetupLogRotate
2024/01/27 13:31:42.408762 [INFO] Initialize LogRotate files and directories
2024/01/27 13:31:42.420646 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:42.420656 [INFO] Executing instruction: BootstrapCFNHup
2024/01/27 13:31:42.420660 [INFO] Bootstrap cfn-hup
2024/01/27 13:31:42.421841 [INFO] Copying file /opt/elasticbeanstalk/config/private/aws-eb-command-handler.conf to /etc/cfn/hooks.d/aws-eb-command-handler.conf
2024/01/27 13:31:42.422973 [INFO] Executing instruction: StartCFNHup
2024/01/27 13:31:42.422979 [INFO] Start cfn-hup
2024/01/27 13:31:42.422996 [INFO] Running command /bin/sh -c systemctl show -p PartOf cfn-hup.service
2024/01/27 13:31:42.439226 [INFO] cfn-hup is not registered with EB yet, registering it now
2024/01/27 13:31:42.439260 [INFO] Running command /bin/sh -c systemctl show -p PartOf cfn-hup.service
2024/01/27 13:31:42.461615 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:31:43.043038 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:31:43.054156 [INFO] Running command /bin/sh -c systemctl is-enabled aws-eb.target
2024/01/27 13:31:43.068136 [INFO] Running command /bin/sh -c systemctl enable aws-eb.target
2024/01/27 13:31:43.647945 [INFO] Running command /bin/sh -c systemctl start aws-eb.target
2024/01/27 13:31:43.668493 [INFO] Running command /bin/sh -c systemctl enable cfn-hup.service
2024/01/27 13:31:44.257941 [INFO] Synchronizing state of cfn-hup.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable cfn-hup
Created symlink /etc/systemd/system/multi-user.target.wants/cfn-hup.service → /etc/systemd/system/cfn-hup.service.

2024/01/27 13:31:44.257975 [INFO] Running command /bin/sh -c systemctl is-active cfn-hup.service
2024/01/27 13:31:44.272886 [INFO] cfn-hup process is not running, starting it now
2024/01/27 13:31:44.272914 [INFO] Running command /bin/sh -c systemctl show -p PartOf cfn-hup.service
2024/01/27 13:31:44.290333 [INFO] Running command /bin/sh -c systemctl is-active cfn-hup.service
2024/01/27 13:31:44.311477 [INFO] Running command /bin/sh -c systemctl start cfn-hup.service
2024/01/27 13:31:44.431643 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:44.431658 [INFO] Executing instruction: SetupPublishLogCronjob
2024/01/27 13:31:44.431662 [INFO] Setup publish logs cron job...
2024/01/27 13:31:44.431667 [INFO] Copying file /opt/elasticbeanstalk/config/private/logtasks/cron/publishlogs to /etc/cron.d/publishlogs
2024/01/27 13:31:44.433689 [INFO] Executing instruction: Start Docker
2024/01/27 13:31:44.433804 [INFO] Starting Docker...
2024/01/27 13:31:44.433872 [INFO] Copying file /opt/elasticbeanstalk/config/private/docker-log.conf to /etc/systemd/system/docker.service.d/docker-log.conf
2024/01/27 13:31:44.435113 [INFO] Copying file /opt/elasticbeanstalk/config/private/docker-rsyslog.conf to /etc/rsyslog.d/docker-log.conf
2024/01/27 13:31:44.436485 [INFO] Running command /bin/sh -c systemctl restart rsyslog.service
2024/01/27 13:31:44.934206 [INFO] Running command /bin/sh -c systemctl show -p PartOf docker.service
2024/01/27 13:31:44.963588 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:31:45.541280 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:31:45.559239 [INFO] Running command /bin/sh -c systemctl show -p PartOf docker.service
2024/01/27 13:31:45.597993 [INFO] Running command /bin/sh -c systemctl is-active docker.service
2024/01/27 13:31:45.617529 [INFO] Running command /bin/sh -c systemctl start docker.service
2024/01/27 13:31:47.455846 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:47.455862 [INFO] Executing instruction: Setup Docker Options
2024/01/27 13:31:47.455866 [INFO] Setting up configurations for docker platform
2024/01/27 13:31:47.468427 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-events.service
2024/01/27 13:31:47.514264 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:31:48.158720 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:31:48.177861 [INFO] Running command /bin/sh -c systemctl enable eb-docker-events.service
2024/01/27 13:31:48.798284 [INFO] Created symlink /etc/systemd/system/docker.service.wants/eb-docker-events.service → /etc/systemd/system/eb-docker-events.service.

2024/01/27 13:31:48.798332 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-events.service
2024/01/27 13:31:48.814348 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-events.service
2024/01/27 13:31:48.827597 [INFO] Running command /bin/sh -c systemctl start eb-docker-events.service
2024/01/27 13:31:48.950064 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:48.950085 [INFO] Executing instruction: MarkBootstrapped
2024/01/27 13:31:48.950090 [INFO] Starting MarkBootstrapped
2024/01/27 13:31:48.950095 [INFO] Instance has NOT been bootstrapped
2024/01/27 13:31:48.950237 [INFO] Marked instance as Bootstrapped
2024/01/27 13:31:48.950243 [INFO] Executing instruction: Save CFN Stack Info
2024/01/27 13:31:48.950324 [INFO] Starting SwitchCFNStack
2024/01/27 13:31:48.950329 [INFO] Executing cleanup logic
2024/01/27 13:31:48.950339 [INFO] Platform Engine finished execution on command: env-launch

2024/01/27 13:32:12.345601 [INFO] Starting...
2024/01/27 13:32:12.345697 [INFO] Starting EBPlatform-PlatformEngine
2024/01/27 13:32:12.345723 [INFO] reading event message file
2024/01/27 13:32:12.345872 [INFO] Engine received EB command cfn-hup-exec

2024/01/27 13:32:12.432634 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/27 13:32:12.806331 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/27 13:32:13.162009 [INFO] checking whether command app-deploy is applicable to this instance...
2024/01/27 13:32:13.162021 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/27 13:32:13.162024 [INFO] Engine command: (app-deploy)

2024/01/27 13:32:13.162028 [INFO] Downloading EB Application...
2024/01/27 13:32:13.162031 [INFO] Region: eu-west-1
2024/01/27 13:32:13.162034 [INFO] envID: e-8gmkc7rmw6
2024/01/27 13:32:13.162040 [INFO] envBucket: elasticbeanstalk-eu-west-1-471947097906
2024/01/27 13:32:13.162043 [INFO] Using manifest file name from command request
2024/01/27 13:32:13.162051 [INFO] Unable to get version manifest file.
2024/01/27 13:32:13.162053 [INFO] Downloading latest manifest available.
2024/01/27 13:32:13.162055 [INFO] Download latest app version manifest
2024/01/27 13:32:13.162145 [INFO] resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest
2024/01/27 13:32:13.201002 [INFO] latestManifest key *: resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706362249316

2024/01/27 13:32:13.201217 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706362249316
2024/01/27 13:32:13.213288 [INFO] Download successful49bytes downloaded
2024/01/27 13:32:13.213386 [INFO] Trying to read and parse version manifest...
2024/01/27 13:32:13.213419 [INFO] Downloading file with path: /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/27 13:32:13.213485 [INFO] URL: https://elasticbeanstalk-platform-assets-eu-west-1.s3.eu-west-1.amazonaws.com/stalks/eb_docker_amazon_linux_2023_1.0.420.0_20240123011222/sampleapp/EBSampleApp-Docker.zip
2024/01/27 13:32:13.233101 [INFO] Finished download file from https://elasticbeanstalk-platform-assets-eu-west-1.s3.eu-west-1.amazonaws.com/stalks/eb_docker_amazon_linux_2023_1.0.420.0_20240123011222/sampleapp/EBSampleApp-Docker.zip
2024/01/27 13:32:13.233437 [INFO] Executing instruction: ElectLeader
2024/01/27 13:32:13.233444 [INFO] Running leader election for instance i-04732eb7c408070b9...
2024/01/27 13:32:13.233452 [INFO] Calling the cfn-elect-cmd-leader to elect the command leader.
2024/01/27 13:32:13.233465 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-elect-cmd-leader --stack arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb --command-name ElasticBeanstalkCommand-AWSEBAutoScalingGroup --invocation-id 7bf527c0-e618-42e4-9303-c7ff8c500384 --listener-id i-04732eb7c408070b9 --region eu-west-1
2024/01/27 13:32:13.608033 [INFO] Instance is Leader.
2024/01/27 13:32:13.608087 [INFO] Executing instruction: stopSqsd
2024/01/27 13:32:13.608110 [INFO] This is a web server environment instance, skip stop sqsd daemon ...
2024/01/27 13:32:13.608113 [INFO] Executing instruction: PreBuildEbExtension
2024/01/27 13:32:13.608116 [INFO] Starting executing the config set Infra-EmbeddedPreBuild.
2024/01/27 13:32:13.608136 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPreBuild
2024/01/27 13:32:14.019144 [INFO] Finished executing the config set Infra-EmbeddedPreBuild.

2024/01/27 13:32:14.019166 [INFO] Executing instruction: StagedockerApplication
2024/01/27 13:32:14.019190 [INFO] Running command /bin/sh -c docker ps -a -q -f status=running
2024/01/27 13:32:14.039366 [INFO] Pruning containers ...
2024/01/27 13:32:14.039393 [INFO] Running command /bin/sh -c docker ps -a
2024/01/27 13:32:14.059052 [INFO] CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

2024/01/27 13:32:14.059082 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/27 13:32:14.076856 [INFO] Total reclaimed space: 0B

2024/01/27 13:32:14.076883 [INFO] Running command /bin/sh -c docker ps -a
2024/01/27 13:32:14.093715 [INFO] CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

2024/01/27 13:32:14.094049 [INFO] Running command /bin/sh -c /bin/file -m /opt/elasticbeanstalk/config/private/beanstalk-magic -b --mime-type /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/27 13:32:14.099248 [INFO] application/zip

2024/01/27 13:32:14.099266 [INFO] app source bundle is zip file ...
2024/01/27 13:32:14.099270 [INFO] extracting /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/
2024/01/27 13:32:14.099281 [INFO] Running command /bin/sh -c /usr/bin/unzip -q -o /opt/elasticbeanstalk/deployment/app_source_bundle -d /var/app/staging/
2024/01/27 13:32:14.102323 [INFO] finished extracting /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/ successfully
2024/01/27 13:32:14.102335 [INFO] Executing instruction: RunAppDeployPreBuildHooks
2024/01/27 13:32:14.102392 [INFO] Executing platform hooks in .platform/hooks/prebuild/
2024/01/27 13:32:14.102407 [INFO] The dir .platform/hooks/prebuild/ does not exist
2024/01/27 13:32:14.102409 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/prebuild
2024/01/27 13:32:14.102414 [INFO] Executing instruction: Generate environment file
2024/01/27 13:32:14.102451 [INFO] Executing instruction: Docker Specific Build Application
2024/01/27 13:32:14.102454 [INFO] start build docker app
2024/01/27 13:32:14.102565 [INFO] fetching image names from Dockerfile /var/app/staging/Dockerfile
2024/01/27 13:32:14.102597 [INFO] found images [public.ecr.aws/docker/library/python:3.8] in Dockerfile /var/app/staging/Dockerfile
2024/01/27 13:32:14.102601 [INFO] pull docker image if update is not false in Dockerrun.aws.json
2024/01/27 13:32:14.102603 [INFO] start to build docker image
2024/01/27 13:32:14.102614 [INFO] Running command /bin/sh -c docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/27 13:32:37.931846 [INFO] #0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 267B done
#1 DONE 0.0s

#2 [internal] load .dockerignore
#2 transferring context: 2B done
#2 DONE 0.0s

#3 [internal] load metadata for public.ecr.aws/docker/library/python:3.8
#3 DONE 1.3s

#4 [internal] load build context
#4 transferring context: 5.30kB done
#4 DONE 0.0s

#5 [1/2] FROM public.ecr.aws/docker/library/python:3.8@sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794
#5 resolve public.ecr.aws/docker/library/python:3.8@sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794 0.0s done
#5 sha256:22b8bf2be7a50eeb14b01322e580485681017032a720604baab1643a90a6b794 1.86kB / 1.86kB done
#5 sha256:fb36df8267c3a647ab9a1af81d1696d3274c0c41c804af0d110b80b79fe4c270 2.01kB / 2.01kB done
#5 sha256:8a90415600108404fbe6f011c525e78dc2709d54c973738b1b960f69f361aef4 7.38kB / 7.38kB done
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 0B / 24.05MB 0.1s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 0B / 49.56MB 0.1s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 0B / 64.14MB 0.1s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 5.40MB / 24.05MB 0.2s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 11.53MB / 49.56MB 0.2s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 13.63MB / 24.05MB 0.3s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 20.17MB / 49.56MB 0.3s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 4.19MB / 64.14MB 0.3s
#5 sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 24.05MB / 24.05MB 0.5s done
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 37.75MB / 49.56MB 0.5s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 20.97MB / 64.14MB 0.5s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 0B / 211.10MB 0.5s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 49.28MB / 49.56MB 0.6s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 32.42MB / 64.14MB 0.6s
#5 sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 49.56MB / 49.56MB 0.7s done
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 41.94MB / 64.14MB 0.7s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 11.53MB / 211.10MB 0.7s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 53.48MB / 64.14MB 0.9s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 25.17MB / 211.10MB 0.9s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 4.19MB / 6.39MB 0.9s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 62.36MB / 64.14MB 1.0s
#5 sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 6.39MB / 6.39MB 0.9s done
#5 extracting sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 0.1s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 0B / 17.28MB 1.0s
#5 sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 64.14MB / 64.14MB 1.1s done
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 38.80MB / 211.10MB 1.1s
#5 sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092 0B / 246B 1.1s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 55.57MB / 211.10MB 1.3s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 73.84MB / 211.10MB 1.5s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 6.29MB / 17.28MB 1.5s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 15.73MB / 17.28MB 1.6s
#5 sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092 246B / 246B 1.5s done
#5 sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 0B / 2.85MB 1.6s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 91.23MB / 211.10MB 1.7s
#5 sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 17.28MB / 17.28MB 1.7s done
#5 sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 1.05MB / 2.85MB 1.7s
#5 sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 2.85MB / 2.85MB 1.8s done
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 111.15MB / 211.10MB 1.9s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 139.46MB / 211.10MB 2.2s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 158.33MB / 211.10MB 2.4s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 182.45MB / 211.10MB 2.6s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 198.18MB / 211.10MB 2.8s
#5 sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 211.10MB / 211.10MB 3.0s done
#5 extracting sha256:1b13d4e1a46e5e969702ec92b7c787c1b6891bff7c21ad378ff6dbc9e751d5d4 3.6s done
#5 extracting sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c
#5 extracting sha256:1c74526957fc2157e8b0989072dc99b9582b398c12d1dcd40270fd76231bab0c 0.9s done
#5 extracting sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980
#5 extracting sha256:30d85599795460b2d9d24c6b87c53ec60555b601705cc83bea31632240500980 3.7s done
#5 extracting sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2
#5 extracting sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 5.1s
#5 extracting sha256:ad5739181616b815fae7edc6bba689496674acbcf44e48a57fc7cc13a379b3a2 10.3s done
#5 extracting sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 0.1s
#5 extracting sha256:75e2b45cbee50cea4b3ed4f4fe167ad5994622d77a54adde89adcfeefa3c229a 0.4s done
#5 extracting sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72
#5 extracting sha256:76c111f84668456d1a37f894e2a1a6fc655cecf002d8b3f7934f4ffc14231f72 0.7s done
#5 extracting sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092
#5 extracting sha256:f4cb18646a15052fbff9e6a7f2af27b73ce3033e9e973709fedf06058817f092 done
#5 extracting sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 0.1s
#5 extracting sha256:0a329b671abfc277cf19a2670d019384c564e146c9c5ed1bb97d173377497d6e 0.3s done
#5 DONE 21.8s

#6 [2/2] ADD application.py /tmp/application.py
#6 DONE 0.0s

#7 exporting to image
#7 exporting layers 0.0s done
#7 writing image sha256:7a4ecba015016647574045fa5516b8a2f16db5b3177272f7c87cd36512b7c855 done
#7 naming to docker.io/aws_beanstalk/staging-app
#7 naming to docker.io/aws_beanstalk/staging-app done
#7 DONE 0.1s

2024/01/27 13:32:37.934199 [INFO] successfully execute command: docker build -t aws_beanstalk/staging-app /var/app/staging/
2024/01/27 13:32:37.934213 [INFO] successfully build docker image
2024/01/27 13:32:37.934216 [INFO] save staging docker image id
2024/01/27 13:32:37.934682 [INFO] Running command /bin/sh -c docker images aws_beanstalk/staging-app -q
2024/01/27 13:32:38.025154 [INFO] 7a4ecba01501

2024/01/27 13:32:38.026964 [INFO] Executing instruction: configure X-Ray
2024/01/27 13:32:38.026980 [INFO] X-Ray is not enabled.
2024/01/27 13:32:38.026983 [INFO] Executing instruction: configure proxy Nginx
2024/01/27 13:32:38.035670 [INFO] Executing instruction: configure healthd specific proxy conf
2024/01/27 13:32:38.038835 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/27 13:32:38.064954 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:32:38.427531 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:32:38.438621 [INFO] Running command /bin/sh -c systemctl is-enabled aws-eb.target
2024/01/27 13:32:38.449932 [INFO] Running command /bin/sh -c systemctl enable aws-eb.target
2024/01/27 13:32:38.793128 [INFO] Running command /bin/sh -c systemctl start aws-eb.target
2024/01/27 13:32:38.803053 [INFO] Running command /bin/sh -c systemctl enable healthd.service
2024/01/27 13:32:39.147333 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/healthd.service → /etc/systemd/system/healthd.service.

2024/01/27 13:32:39.147379 [INFO] Running command /bin/sh -c systemctl show -p PartOf healthd.service
2024/01/27 13:32:39.158740 [INFO] Running command /bin/sh -c systemctl is-active healthd.service
2024/01/27 13:32:39.166319 [INFO] Running command /bin/sh -c systemctl start healthd.service
2024/01/27 13:32:39.215293 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_logformat.conf to /var/proxy/staging/nginx/conf.d/healthd_logformat.conf
2024/01/27 13:32:39.216460 [INFO] Copying file /opt/elasticbeanstalk/config/private/healthd/healthd_nginx.conf to /var/proxy/staging/nginx/conf.d/elasticbeanstalk/healthd.conf
2024/01/27 13:32:39.217185 [INFO] Executing instruction: configure log streaming
2024/01/27 13:32:39.217194 [INFO] log streaming is not enabled
2024/01/27 13:32:39.217197 [INFO] disable log stream
2024/01/27 13:32:39.217209 [INFO] Running command /bin/sh -c systemctl show -p PartOf amazon-cloudwatch-agent.service
2024/01/27 13:32:39.233229 [INFO] Running command /bin/sh -c systemctl stop amazon-cloudwatch-agent.service
2024/01/27 13:32:39.248588 [INFO] Executing instruction: GetToggleForceRotate
2024/01/27 13:32:39.248606 [INFO] Checking if logs need forced rotation
2024/01/27 13:32:39.248625 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/27 13:32:39.885093 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/27 13:32:40.369700 [INFO] Procfile not found. Generating default rsyslog config
2024/01/27 13:32:40.372140 [INFO] Running command /bin/sh -c systemctl restart rsyslog.service
2024/01/27 13:32:40.867095 [INFO] Executing instruction: Configure Docker Logging
2024/01/27 13:32:40.883689 [INFO] Executing instruction: PostBuildEbExtension
2024/01/27 13:32:40.883704 [INFO] Starting executing the config set Infra-EmbeddedPostBuild.
2024/01/27 13:32:40.883715 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPostBuild
2024/01/27 13:32:41.262515 [INFO] Finished executing the config set Infra-EmbeddedPostBuild.

2024/01/27 13:32:41.262535 [INFO] Executing instruction: CleanEbExtensions
2024/01/27 13:32:41.262558 [INFO] Cleaned ebextensions subdirectories from app staging directory.
2024/01/27 13:32:41.262561 [INFO] Executing instruction: RunAppDeployPreDeployHooks
2024/01/27 13:32:41.262581 [INFO] Executing platform hooks in .platform/hooks/predeploy/
2024/01/27 13:32:41.262592 [INFO] The dir .platform/hooks/predeploy/ does not exist
2024/01/27 13:32:41.262594 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/predeploy
2024/01/27 13:32:41.262599 [INFO] Executing instruction: stop X-Ray
2024/01/27 13:32:41.262602 [INFO] stop X-Ray ...
2024/01/27 13:32:41.262614 [INFO] Running command /bin/sh -c systemctl show -p PartOf xray.service
2024/01/27 13:32:41.277479 [WARN] stopProcess Warning: process xray is not registered 
2024/01/27 13:32:41.277509 [INFO] Running command /bin/sh -c systemctl stop xray.service
2024/01/27 13:32:41.298162 [INFO] Executing instruction: Run Docker Container
2024/01/27 13:32:41.298253 [INFO] this is the first time deploying app...
2024/01/27 13:32:41.298257 [INFO] Removing /var/app/current/ if it exists
2024/01/27 13:32:41.298264 [INFO] Renaming /var/app/staging/ to /var/app/current/
2024/01/27 13:32:41.298822 [INFO] detected new app is not docker compose app
2024/01/27 13:32:41.299659 [INFO] Running command /bin/sh -c docker run -d --env-file /opt/elasticbeanstalk/deployment/env.list -v /var/log/eb-docker/containers/eb-current-app:/tmp/sample-app  7a4ecba01501 
2024/01/27 13:32:42.219579 [INFO] 8efb9b8df0a9b42880964b07a5aa70465a71b2dc88072cd1e56323660ea7059d

2024/01/27 13:32:47.220104 [INFO] Running command /bin/sh -c docker ps | grep -q 8efb9b8df0a9
2024/01/27 13:32:47.245792 [INFO] Clear existing beanstalk iptables rules...
2024/01/27 13:32:47.245822 [INFO] Running command /bin/sh -c iptables-save | grep -v added_by_elasticbeanstalk | iptables-restore
2024/01/27 13:32:47.328886 [INFO] Getting container info...
2024/01/27 13:32:47.328916 [INFO] Running command /bin/sh -c docker inspect 8efb9b8df0a9b42880964b07a5aa70465a71b2dc88072cd1e56323660ea7059d

2024/01/27 13:32:47.350675 [INFO] Running command /bin/sh -c ip route show default | awk '{print $5}'
2024/01/27 13:32:47.372132 [INFO] ens5

2024/01/27 13:32:47.372256 [INFO] Writing nginx upstream config...
2024/01/27 13:32:47.375955 [INFO] Running command /bin/sh -c /usr/sbin/nginx -t -c /var/proxy/staging/nginx/nginx.conf
2024/01/27 13:32:47.423725 [INFO] nginx: [warn] could not build optimal types_hash, you should increase either types_hash_max_size: 1024 or types_hash_bucket_size: 64; ignoring types_hash_bucket_size
nginx: the configuration file /var/proxy/staging/nginx/nginx.conf syntax is ok
nginx: configuration file /var/proxy/staging/nginx/nginx.conf test is successful

2024/01/27 13:32:47.423827 [INFO] Running command /bin/sh -c cp -rp /var/proxy/staging/nginx/* /etc/nginx
2024/01/27 13:32:47.429885 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/27 13:32:47.452451 [INFO] register process nginx
2024/01/27 13:32:47.452483 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/27 13:32:47.469695 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:32:47.787827 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:32:47.800066 [INFO] Running command /bin/sh -c systemctl enable nginx.service
2024/01/27 13:32:48.178416 [INFO] Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service → /usr/lib/systemd/system/nginx.service.

2024/01/27 13:32:48.178543 [INFO] Running command /bin/sh -c systemctl show -p PartOf nginx.service
2024/01/27 13:32:48.194377 [INFO] Running command /bin/sh -c systemctl restart nginx.service
2024/01/27 13:32:48.305341 [INFO] Running command /bin/sh -c service iptables save
2024/01/27 13:32:48.382727 [INFO] iptables: Saving firewall rules to /etc/sysconfig/iptables: [  OK  ]

2024/01/27 13:32:48.382742 [INFO] Traffic forward set-up completed.
2024/01/27 13:32:48.382744 [INFO] making STAGING app container current...
2024/01/27 13:32:48.382756 [INFO] Running command /bin/sh -c docker tag 7a4ecba01501 aws_beanstalk/current-app
2024/01/27 13:32:48.411326 [INFO] Running command /bin/sh -c docker rmi aws_beanstalk/staging-app
2024/01/27 13:32:48.438584 [INFO] Untagged: aws_beanstalk/staging-app:latest

2024/01/27 13:32:48.438791 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/27 13:32:48.456057 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:32:48.821161 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:32:48.833432 [INFO] Running command /bin/sh -c systemctl enable eb-docker.service
2024/01/27 13:32:49.202929 [INFO] The unit files have no installation config (WantedBy=, RequiredBy=, Also=,
Alias= settings in the [Install] section, and DefaultInstance= for template
units). This means they are not meant to be enabled using systemctl.
 
Possible reasons for having this kind of units are:
• A unit may be statically enabled by being symlinked from another unit's
  .wants/ or .requires/ directory.
• A unit's purpose may be to act as a helper for some other unit which has
  a requirement dependency on it.
• A unit may be started when needed via activation (socket, path, timer,
  D-Bus, udev, scripted systemctl call, ...).
• In case of template units, the unit is meant to be enabled with some
  instance name specified.

2024/01/27 13:32:49.202962 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker.service
2024/01/27 13:32:49.219353 [INFO] Running command /bin/sh -c systemctl is-active eb-docker.service
2024/01/27 13:32:49.228777 [INFO] Running command /bin/sh -c systemctl start eb-docker.service
2024/01/27 13:32:49.332335 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/27 13:32:49.349130 [INFO] Running command /bin/sh -c systemctl daemon-reload
2024/01/27 13:32:49.811804 [INFO] Running command /bin/sh -c systemctl reset-failed
2024/01/27 13:32:49.823096 [INFO] Running command /bin/sh -c systemctl enable eb-docker-log.service
2024/01/27 13:32:50.133526 [INFO] Created symlink /etc/systemd/system/eb-docker.service.wants/eb-docker-log.service → /etc/systemd/system/eb-docker-log.service.

2024/01/27 13:32:50.133561 [INFO] Running command /bin/sh -c systemctl show -p PartOf eb-docker-log.service
2024/01/27 13:32:50.158478 [INFO] Running command /bin/sh -c systemctl is-active eb-docker-log.service
2024/01/27 13:32:50.172664 [INFO] Running command /bin/sh -c systemctl start eb-docker-log.service
2024/01/27 13:32:50.288572 [INFO] docker container 8efb9b8df0a9 is running aws_beanstalk/current-app
2024/01/27 13:32:50.288596 [INFO] Cleanup images ...
2024/01/27 13:32:50.288612 [INFO] Running command /bin/sh -c docker images -a
2024/01/27 13:32:50.348399 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED          SIZE
aws_beanstalk/current-app   latest    7a4ecba01501   13 seconds ago   998MB

2024/01/27 13:32:50.348430 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/27 13:32:50.460647 [INFO] Error response from daemon: conflict: unable to delete 7a4ecba01501 (cannot be forced) - image is being used by running container 8efb9b8df0a9

2024/01/27 13:32:50.460672 [INFO] Running command /bin/sh -c docker images -a
2024/01/27 13:32:50.501197 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED          SIZE
aws_beanstalk/current-app   latest    7a4ecba01501   13 seconds ago   998MB

2024/01/27 13:32:50.501224 [INFO] Executing instruction: start X-Ray
2024/01/27 13:32:50.501230 [INFO] X-Ray is not enabled.
2024/01/27 13:32:50.501234 [INFO] Executing instruction: configureSqsd
2024/01/27 13:32:50.501310 [INFO] This is a web server environment instance, skip configure sqsd daemon ...
2024/01/27 13:32:50.501315 [INFO] Executing instruction: startSqsd
2024/01/27 13:32:50.501318 [INFO] This is a web server environment instance, skip start sqsd daemon ...
2024/01/27 13:32:50.501323 [INFO] Executing instruction: Track pids in healthd
2024/01/27 13:32:50.501327 [INFO] This is an enhanced health env...
2024/01/27 13:32:50.501344 [INFO] Running command /bin/sh -c systemctl show -p ConsistsOf aws-eb.target | cut -d= -f2
2024/01/27 13:32:50.532080 [INFO] nginx.service healthd.service eb-docker-log.service docker.service eb-docker-events.service eb-docker.service cfn-hup.service

2024/01/27 13:32:50.532122 [INFO] Running command /bin/sh -c systemctl show -p ConsistsOf eb-app.target | cut -d= -f2
2024/01/27 13:32:50.553954 [INFO] 

2024/01/27 13:32:50.559285 [INFO] Executing instruction: RunAppDeployPostDeployHooks
2024/01/27 13:32:50.559312 [INFO] Executing platform hooks in .platform/hooks/postdeploy/
2024/01/27 13:32:50.559328 [INFO] The dir .platform/hooks/postdeploy/ does not exist
2024/01/27 13:32:50.559332 [INFO] Finished running scripts in /var/app/current/.platform/hooks/postdeploy
2024/01/27 13:32:50.559338 [INFO] Executing cleanup logic
2024/01/27 13:32:50.559470 [INFO] CommandService Response: {"status":"SUCCESS","api_version":"1.0","results":[{"status":"SUCCESS","msg":"Engine execution has succeeded.","returncode":0,"events":[{"msg":"Instance deployment completed successfully.","timestamp":1706362370559,"severity":"INFO"}]}]}

2024/01/27 13:32:50.559613 [INFO] Platform Engine finished execution on command: app-deploy

2024/01/29 17:20:52.762833 [INFO] Starting...
2024/01/29 17:20:52.762872 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 17:20:52.762893 [INFO] reading event message file
2024/01/29 17:20:52.763512 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 17:20:52.891457 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 17:20:53.331473 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 17:20:53.708518 [INFO] checking whether command app-deploy is applicable to this instance...
2024/01/29 17:20:53.708533 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 17:20:53.708537 [INFO] Engine command: (app-deploy)

2024/01/29 17:20:53.708549 [INFO] Downloading EB Application...
2024/01/29 17:20:53.708590 [INFO] Region: eu-west-1
2024/01/29 17:20:53.708593 [INFO] envID: e-8gmkc7rmw6
2024/01/29 17:20:53.708597 [INFO] envBucket: elasticbeanstalk-eu-west-1-471947097906
2024/01/29 17:20:53.708601 [INFO] Using manifest file name from command request
2024/01/29 17:20:53.708609 [INFO] Manifest name is : manifest_1706548831584
2024/01/29 17:20:53.708612 [INFO] Download app version manifest
2024/01/29 17:20:53.708845 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706548831584
2024/01/29 17:20:53.757072 [INFO] Download successful122bytes downloaded
2024/01/29 17:20:53.757244 [INFO] Trying to read and parse version manifest...
2024/01/29 17:20:53.757372 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/_versions/hisab-backend/4f1122e696af6b80230fe2eb330e346720f5d9ec
2024/01/29 17:20:53.775068 [INFO] Download successful183bytes downloaded
2024/01/29 17:20:53.775948 [INFO] Executing instruction: ElectLeader
2024/01/29 17:20:53.775956 [INFO] Running leader election for instance i-04732eb7c408070b9...
2024/01/29 17:20:53.775959 [INFO] Calling the cfn-elect-cmd-leader to elect the command leader.
2024/01/29 17:20:53.775974 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-elect-cmd-leader --stack arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb --command-name ElasticBeanstalkCommand-AWSEBAutoScalingGroup --invocation-id d202d662-b283-4b71-8c0d-5c2010d1f79f --listener-id i-04732eb7c408070b9 --region eu-west-1
2024/01/29 17:20:54.149793 [INFO] Instance is Leader.
2024/01/29 17:20:54.149845 [INFO] Executing instruction: stopSqsd
2024/01/29 17:20:54.149851 [INFO] This is a web server environment instance, skip stop sqsd daemon ...
2024/01/29 17:20:54.149854 [INFO] Executing instruction: PreBuildEbExtension
2024/01/29 17:20:54.149858 [INFO] Starting executing the config set Infra-EmbeddedPreBuild.
2024/01/29 17:20:54.149877 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPreBuild
2024/01/29 17:20:54.549027 [INFO] Finished executing the config set Infra-EmbeddedPreBuild.

2024/01/29 17:20:54.549049 [INFO] Executing instruction: StagedockerApplication
2024/01/29 17:20:54.549060 [INFO] Running command /bin/sh -c docker ps -a -q -f status=running
2024/01/29 17:20:54.567817 [INFO] 8efb9b8df0a9

2024/01/29 17:20:54.567836 [INFO] Pruning containers ...
2024/01/29 17:20:54.567847 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 17:20:54.583678 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED      STATUS      PORTS      NAMES
8efb9b8df0a9   7a4ecba01501   "python /tmp/applica…"   2 days ago   Up 2 days   8000/tcp   elated_noether

2024/01/29 17:20:54.583705 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 17:20:54.600522 [INFO] Total reclaimed space: 0B

2024/01/29 17:20:54.600571 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 17:20:54.625356 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED      STATUS      PORTS      NAMES
8efb9b8df0a9   7a4ecba01501   "python /tmp/applica…"   2 days ago   Up 2 days   8000/tcp   elated_noether

2024/01/29 17:20:54.625379 [INFO] Cleanup images ...
2024/01/29 17:20:54.625392 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 17:20:54.644297 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED      SIZE
aws_beanstalk/current-app   latest    7a4ecba01501   2 days ago   998MB

2024/01/29 17:20:54.644333 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/29 17:20:54.678273 [INFO] Error response from daemon: conflict: unable to delete 7a4ecba01501 (cannot be forced) - image is being used by running container 8efb9b8df0a9

2024/01/29 17:20:54.678298 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 17:20:54.707066 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED      SIZE
aws_beanstalk/current-app   latest    7a4ecba01501   2 days ago   998MB

2024/01/29 17:20:54.707423 [INFO] Running command /bin/sh -c /bin/file -m /opt/elasticbeanstalk/config/private/beanstalk-magic -b --mime-type /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 17:20:54.713841 [INFO] application/json

2024/01/29 17:20:54.713863 [INFO] Running command /bin/sh -c docker compose -f /opt/elasticbeanstalk/deployment/app_source_bundle config -q
2024/01/29 17:20:55.145889 [INFO] validating /opt/elasticbeanstalk/deployment/app_source_bundle: (root) Additional property AWSEBDockerrunVersion is not allowed

2024/01/29 17:20:55.146060 [INFO] Copying file /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/Dockerrun.aws.json
2024/01/29 17:20:55.147081 [INFO] Executing instruction: RunAppDeployPreBuildHooks
2024/01/29 17:20:55.147105 [INFO] Executing platform hooks in .platform/hooks/prebuild/
2024/01/29 17:20:55.147119 [INFO] The dir .platform/hooks/prebuild/ does not exist
2024/01/29 17:20:55.147123 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/prebuild
2024/01/29 17:20:55.147128 [INFO] Executing instruction: Generate environment file
2024/01/29 17:20:55.147159 [INFO] Executing instruction: Docker Specific Build Application
2024/01/29 17:20:55.147162 [INFO] start build docker app
2024/01/29 17:20:55.147436 [INFO] generate dockerfile with the image and ports from Dockerrun.aws.json
2024/01/29 17:20:55.147440 [INFO] fetching image and ports
2024/01/29 17:20:55.149354 [INFO] fetching image names from Dockerfile /var/app/staging/Dockerfile
2024/01/29 17:20:55.149478 [INFO] found images [hashimhisab/hisab-backend:latest] in Dockerfile /var/app/staging/Dockerfile
2024/01/29 17:20:55.149487 [INFO] pull docker image if update is not false in Dockerrun.aws.json
2024/01/29 17:20:55.149502 [INFO] Running command /bin/sh -c docker pull hashimhisab/hisab-backend:latest
2024/01/29 17:20:56.051276 [INFO] Error response from daemon: pull access denied for hashimhisab/hisab-backend, repository does not exist or may require 'docker login': denied: requested access to the resource is denied

2024/01/29 17:20:56.051297 [WARN] failed to execute command: docker pull hashimhisab/hisab-backend:latest, retrying...
2024/01/29 17:20:56.051309 [INFO] Running command /bin/sh -c docker pull hashimhisab/hisab-backend:latest
2024/01/29 17:20:56.937121 [INFO] Error response from daemon: pull access denied for hashimhisab/hisab-backend, repository does not exist or may require 'docker login': denied: requested access to the resource is denied

2024/01/29 17:20:56.937149 [ERROR] An error occurred during execution of command [app-deploy] - [Docker Specific Build Application]. Stop running the command. Error: failed to pull docker image: Command /bin/sh -c docker pull hashimhisab/hisab-backend:latest failed with error exit status 1. Stderr:Error response from daemon: pull access denied for hashimhisab/hisab-backend, repository does not exist or may require 'docker login': denied: requested access to the resource is denied
 

2024/01/29 17:20:56.937172 [INFO] Executing cleanup logic
2024/01/29 17:20:56.937430 [INFO] CommandService Response: {"status":"FAILURE","api_version":"1.0","results":[{"status":"FAILURE","msg":"Engine execution has encountered an error.","returncode":1,"events":[{"msg":"Instance deployment failed to download the Docker image. The deployment failed.","timestamp":1706548856937,"severity":"ERROR"},{"msg":"Instance deployment failed. For details, see 'eb-engine.log'.","timestamp":1706548856937,"severity":"ERROR"}]}]}

2024/01/29 17:20:56.937847 [INFO] Platform Engine finished execution on command: app-deploy

2024/01/29 17:21:17.506371 [INFO] Starting...
2024/01/29 17:21:17.506405 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 17:21:17.506429 [INFO] reading event message file
2024/01/29 17:21:17.506586 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 17:21:17.578151 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 17:21:17.961993 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 17:21:18.356407 [INFO] checking whether command bundle-log is applicable to this instance...
2024/01/29 17:21:18.356427 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 17:21:18.356431 [INFO] Engine command: (bundle-log)

2024/01/29 17:21:18.356496 [INFO] Executing instruction: GetBundleLogs
2024/01/29 17:21:18.356501 [INFO] Bundle Logs...
2024/01/29 17:21:18.767459 [INFO] Executing cleanup logic
2024/01/29 17:21:18.767568 [INFO] CommandService Response: {"status":"SUCCESS","api_version":"1.0","results":[{"status":"SUCCESS","msg":"Engine execution has succeeded.","returncode":0,"events":[{"msg":"Instance deployment completed successfully.","timestamp":1706548878767,"severity":"INFO"}]}]}

2024/01/29 17:21:18.767586 [INFO] Platform Engine finished execution on command: bundle-log

2024/01/29 17:39:24.842330 [INFO] Starting...
2024/01/29 17:39:24.842371 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 17:39:24.842391 [INFO] reading event message file
2024/01/29 17:39:24.842550 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 17:39:24.916322 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 17:39:25.258608 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 17:39:25.592427 [INFO] checking whether command app-deploy is applicable to this instance...
2024/01/29 17:39:25.592440 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 17:39:25.592443 [INFO] Engine command: (app-deploy)

2024/01/29 17:39:25.592447 [INFO] Downloading EB Application...
2024/01/29 17:39:25.592450 [INFO] Region: eu-west-1
2024/01/29 17:39:25.592452 [INFO] envID: e-8gmkc7rmw6
2024/01/29 17:39:25.592455 [INFO] envBucket: elasticbeanstalk-eu-west-1-471947097906
2024/01/29 17:39:25.592459 [INFO] Using manifest file name from command request
2024/01/29 17:39:25.592468 [INFO] Manifest name is : manifest_1706549943533
2024/01/29 17:39:25.592471 [INFO] Download app version manifest
2024/01/29 17:39:25.592607 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/versions/manifest_1706549943533
2024/01/29 17:39:25.627505 [INFO] Download successful122bytes downloaded
2024/01/29 17:39:25.627633 [INFO] Trying to read and parse version manifest...
2024/01/29 17:39:25.627820 [INFO] Downloading: bucket: elasticbeanstalk-eu-west-1-471947097906, object: /resources/environments/e-8gmkc7rmw6/_runtime/_versions/hisab-backend/fdc4d1a220d750f9a4a24773da578ca8ecca3fe3
2024/01/29 17:39:25.639975 [INFO] Download successful264bytes downloaded
2024/01/29 17:39:25.640215 [INFO] Executing instruction: ElectLeader
2024/01/29 17:39:25.640221 [INFO] Running leader election for instance i-04732eb7c408070b9...
2024/01/29 17:39:25.640223 [INFO] Calling the cfn-elect-cmd-leader to elect the command leader.
2024/01/29 17:39:25.640237 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-elect-cmd-leader --stack arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb --command-name ElasticBeanstalkCommand-AWSEBAutoScalingGroup --invocation-id 7d6036e7-8823-42e8-897c-9b6eee7ebc3c --listener-id i-04732eb7c408070b9 --region eu-west-1
2024/01/29 17:39:26.092606 [INFO] Instance is Leader.
2024/01/29 17:39:26.092659 [INFO] Executing instruction: stopSqsd
2024/01/29 17:39:26.092663 [INFO] This is a web server environment instance, skip stop sqsd daemon ...
2024/01/29 17:39:26.092666 [INFO] Executing instruction: PreBuildEbExtension
2024/01/29 17:39:26.092669 [INFO] Starting executing the config set Infra-EmbeddedPreBuild.
2024/01/29 17:39:26.092682 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-init -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1 --configsets Infra-EmbeddedPreBuild
2024/01/29 17:39:26.495617 [INFO] Finished executing the config set Infra-EmbeddedPreBuild.

2024/01/29 17:39:26.495663 [INFO] Executing instruction: StagedockerApplication
2024/01/29 17:39:26.495676 [INFO] Running command /bin/sh -c docker ps -a -q -f status=running
2024/01/29 17:39:26.516034 [INFO] 8efb9b8df0a9

2024/01/29 17:39:26.516055 [INFO] Pruning containers ...
2024/01/29 17:39:26.516069 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 17:39:26.538358 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED      STATUS      PORTS      NAMES
8efb9b8df0a9   7a4ecba01501   "python /tmp/applica…"   2 days ago   Up 2 days   8000/tcp   elated_noether

2024/01/29 17:39:26.538391 [INFO] Running command /bin/sh -c docker container prune -f
2024/01/29 17:39:26.556702 [INFO] Total reclaimed space: 0B

2024/01/29 17:39:26.556723 [INFO] Running command /bin/sh -c docker ps -a
2024/01/29 17:39:26.572371 [INFO] CONTAINER ID   IMAGE          COMMAND                  CREATED      STATUS      PORTS      NAMES
8efb9b8df0a9   7a4ecba01501   "python /tmp/applica…"   2 days ago   Up 2 days   8000/tcp   elated_noether

2024/01/29 17:39:26.572389 [INFO] Cleanup images ...
2024/01/29 17:39:26.572399 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 17:39:26.590533 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED      SIZE
aws_beanstalk/current-app   latest    7a4ecba01501   2 days ago   998MB

2024/01/29 17:39:26.590587 [INFO] Running command /bin/sh -c docker rmi `docker images -aq`
2024/01/29 17:39:26.630504 [INFO] Error response from daemon: conflict: unable to delete 7a4ecba01501 (cannot be forced) - image is being used by running container 8efb9b8df0a9

2024/01/29 17:39:26.630527 [INFO] Running command /bin/sh -c docker images -a
2024/01/29 17:39:26.656814 [INFO] REPOSITORY                  TAG       IMAGE ID       CREATED      SIZE
aws_beanstalk/current-app   latest    7a4ecba01501   2 days ago   998MB

2024/01/29 17:39:26.657043 [INFO] Running command /bin/sh -c /bin/file -m /opt/elasticbeanstalk/config/private/beanstalk-magic -b --mime-type /opt/elasticbeanstalk/deployment/app_source_bundle
2024/01/29 17:39:26.659494 [INFO] application/json

2024/01/29 17:39:26.659527 [INFO] Running command /bin/sh -c docker compose -f /opt/elasticbeanstalk/deployment/app_source_bundle config -q
2024/01/29 17:39:26.734001 [INFO] validating /opt/elasticbeanstalk/deployment/app_source_bundle: (root) Additional property AWSEBDockerrunVersion is not allowed

2024/01/29 17:39:26.734280 [INFO] Copying file /opt/elasticbeanstalk/deployment/app_source_bundle to /var/app/staging/Dockerrun.aws.json
2024/01/29 17:39:26.735357 [INFO] Executing instruction: RunAppDeployPreBuildHooks
2024/01/29 17:39:26.735442 [INFO] Executing platform hooks in .platform/hooks/prebuild/
2024/01/29 17:39:26.735460 [INFO] The dir .platform/hooks/prebuild/ does not exist
2024/01/29 17:39:26.735462 [INFO] Finished running scripts in /var/app/staging/.platform/hooks/prebuild
2024/01/29 17:39:26.735467 [INFO] Executing instruction: Generate environment file
2024/01/29 17:39:26.735494 [INFO] Executing instruction: Docker Specific Build Application
2024/01/29 17:39:26.735497 [INFO] start build docker app
2024/01/29 17:39:26.735874 [INFO] generate dockerfile with the image and ports from Dockerrun.aws.json
2024/01/29 17:39:26.735878 [INFO] fetching image and ports
2024/01/29 17:39:26.737500 [INFO] fetching image names from Dockerfile /var/app/staging/Dockerfile
2024/01/29 17:39:26.737648 [INFO] found images [471947097906.dkr.ecr.eu-west-1.amazonaws.com/hisab-backend/hisab-backend:fdc4d1a220d750f9a4a24773da578ca8ecca3fe3] in Dockerfile /var/app/staging/Dockerfile
2024/01/29 17:39:26.737659 [INFO] authenticate with ECR if the image is in an ECR repo
2024/01/29 17:39:26.737668 [INFO] Running command /bin/sh -c aws ecr get-login-password --region eu-west-1 | docker login --username AWS --password-stdin 471947097906.dkr.ecr.eu-west-1.amazonaws.com
2024/01/29 17:39:28.224861 [INFO] 
An error occurred (AccessDeniedException) when calling the GetAuthorizationToken operation: User: arn:aws:sts::471947097906:assumed-role/aws-elasticbeanstalk-ec2-role/i-04732eb7c408070b9 is not authorized to perform: ecr:GetAuthorizationToken on resource: * because no identity-based policy allows the ecr:GetAuthorizationToken action
Error: Cannot perform an interactive login from a non TTY device

2024/01/29 17:39:28.225189 [ERROR] An error occurred during execution of command [app-deploy] - [Docker Specific Build Application]. Stop running the command. Error: failed to authenticate with ECR for registry 471947097906.dkr.ecr.eu-west-1.amazonaws.com in eu-west-1: Command /bin/sh -c aws ecr get-login-password --region eu-west-1 | docker login --username AWS --password-stdin 471947097906.dkr.ecr.eu-west-1.amazonaws.com failed with error exit status 1. Stderr:
An error occurred (AccessDeniedException) when calling the GetAuthorizationToken operation: User: arn:aws:sts::471947097906:assumed-role/aws-elasticbeanstalk-ec2-role/i-04732eb7c408070b9 is not authorized to perform: ecr:GetAuthorizationToken on resource: * because no identity-based policy allows the ecr:GetAuthorizationToken action
Error: Cannot perform an interactive login from a non TTY device
 

2024/01/29 17:39:28.225195 [INFO] Executing cleanup logic
2024/01/29 17:39:28.225286 [INFO] CommandService Response: {"status":"FAILURE","api_version":"1.0","results":[{"status":"FAILURE","msg":"Engine execution has encountered an error.","returncode":1,"events":[{"msg":"Instance deployment: The ECR service failed to authenticate your private repository. The deployment failed.","timestamp":1706549968225,"severity":"ERROR"},{"msg":"Instance deployment failed. For details, see 'eb-engine.log'.","timestamp":1706549968225,"severity":"ERROR"}]}]}

2024/01/29 17:39:28.226126 [INFO] Platform Engine finished execution on command: app-deploy

2024/01/29 17:39:58.016982 [INFO] Starting...
2024/01/29 17:39:58.017020 [INFO] Starting EBPlatform-PlatformEngine
2024/01/29 17:39:58.017042 [INFO] reading event message file
2024/01/29 17:39:58.017225 [INFO] Engine received EB command cfn-hup-exec

2024/01/29 17:39:58.086275 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBAutoScalingGroup --region eu-west-1
2024/01/29 17:39:58.487029 [INFO] Running command /bin/sh -c /opt/aws/bin/cfn-get-metadata -s arn:aws:cloudformation:eu-west-1:471947097906:stack/awseb-e-8gmkc7rmw6-stack/490911e0-bd18-11ee-b0a0-02053dd7f0eb -r AWSEBBeanstalkMetadata --region eu-west-1
2024/01/29 17:39:58.879366 [INFO] checking whether command bundle-log is applicable to this instance...
2024/01/29 17:39:58.879377 [INFO] this command is applicable to the instance, thus instance should execute command
2024/01/29 17:39:58.879379 [INFO] Engine command: (bundle-log)

2024/01/29 17:39:58.879430 [INFO] Executing instruction: GetBundleLogs
2024/01/29 17:39:58.879433 [INFO] Bundle Logs...
